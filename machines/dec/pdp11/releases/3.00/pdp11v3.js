(function(){/*
 https://www.pcjs.org/modules/dl11.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/pc11.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/defs.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/numio.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/stdio.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/webio.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/device.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/input.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/led.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/time.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/bus.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/memory.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/ports.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/ram.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/rom.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/cpu.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/debugger.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/pdp11ops.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/pdp11.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/pdp11dbg.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/iopage.js (C) 2012-2021 Jeff Parsons
 https://www.pcjs.org/modules/machine.js (C) 2012-2021 Jeff Parsons
*/
var l;function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function ba(a){if(!(a instanceof Array)){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];a=b?b.call(a):{next:aa(a)};for(var c=[];!(b=a.next()).done;)c.push(b.value);a=c}return a}
var ca="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},da="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};
function ea(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var fa=ea(this);function m(a,b){if(b)a:{var c=fa;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))break a;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&da(c,a,{configurable:!0,writable:!0,value:b})}}var ha;
if("function"==typeof Object.setPrototypeOf)ha=Object.setPrototypeOf;else{var ia;a:{var ja={a:!0},ka={};try{ka.__proto__=ja;ia=ka.a;break a}catch(a){}ia=!1}ha=ia?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var la=ha;
function v(a,b){a.prototype=ca(b.prototype);a.prototype.constructor=a;if(la)la(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.fh=b.prototype}function ma(){for(var a=Number(this),b=[],c=a;c<arguments.length;c++)b[c-a]=arguments[c];return b}
m("Math.trunc",function(a){return a?a:function(b){b=Number(b);if(isNaN(b)||Infinity===b||-Infinity===b||0===b)return b;var c=Math.floor(Math.abs(b));return 0>b?-c:c}});m("Math.log2",function(a){return a?a:function(b){return Math.log(b)/Math.LN2}});
m("String.prototype.repeat",function(a){return a?a:function(b){if(null==this)throw new TypeError("The 'this' value for String.prototype.repeat must not be null or undefined");var c=this;if(0>b||1342177279<b)throw new RangeError("Invalid count value");b|=0;for(var d="";b;)if(b&1&&(d+=c),b>>>=1)c+=c;return d}});
m("Symbol",function(a){function b(f){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c(d+(f||"")+"_"+e++,f)}function c(f,g){this.I=f;da(this,"description",{configurable:!0,writable:!0,value:g})}if(a)return a;c.prototype.toString=function(){return this.I};var d="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",e=0;return b});
m("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=fa[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&da(d.prototype,a,{configurable:!0,writable:!0,value:function(){return na(aa(this))}})}return a});function na(a){a={next:a};a[Symbol.iterator]=function(){return this};return a}
function oa(a,b){a instanceof String&&(a+="");var c=0,d=!1,e={next:function(){if(!d&&c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}d=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e}m("Array.prototype.keys",function(a){return a?a:function(){return oa(this,function(b){return b})}});
m("Array.prototype.fill",function(a){return a?a:function(b,c,d){var e=this.length||0;0>c&&(c=Math.max(0,e+c));if(null==d||d>e)d=e;d=Number(d);0>d&&(d=Math.max(0,e+d));for(c=Number(c||0);c<d;c++)this[c]=b;return this}});function pa(a){return a?a:Array.prototype.fill}m("Int8Array.prototype.fill",pa);m("Uint8Array.prototype.fill",pa);m("Uint8ClampedArray.prototype.fill",pa);m("Int16Array.prototype.fill",pa);m("Uint16Array.prototype.fill",pa);m("Int32Array.prototype.fill",pa);
m("Uint32Array.prototype.fill",pa);m("Float32Array.prototype.fill",pa);m("Float64Array.prototype.fill",pa);m("Number.parseInt",function(a){return a||parseInt});m("Array.prototype.values",function(a){return a?a:function(){return oa(this,function(b,c){return c})}});function qa(){}var ra,sa=new ArrayBuffer(2);(new DataView(sa)).setUint16(0,256,!0);ra=256===(new Uint16Array(sa))[0];
var y={$b:0xffffffffffff,NONE:0,od:0,Va:0x800000000000},ta={Yd:{Xa:4,ua:16},jc:{Xa:5,ua:32},sd:{Xa:6,ua:64},dc:{Xa:8,ua:256},td:{Xa:20,ua:1048576},Pg:{Xa:22,ua:4194304}},z={};z.Defs=qa;function ua(){}v(ua,qa);
function va(a,b){if(a){b||(b=10);var c,d=0<a.indexOf(",");d&&(a=a.replace(/,/g,""));var e=c=a.charAt(0);"#"==c?(b=8,c=""):"$"==c&&(b=16,c="");e!=c?a=a.substr(1):(e=c=a.substr(0,2),"0b"==c&&d||"^B"==c?(b=2,c=""):"0o"==c||"^O"==c?(b=8,c=""):"^D"==c?(b=10,c=""):"0x"==c&&(b=16,c=""),e!=c&&(a=a.substr(2)));e=c=a.slice(-1);"Y"==c||"y"==c?(b=2,c=""):"."==c?(b=10,c=""):"H"==c||"h"==c?(b=16,c=""):"K"==c?c="000":"M"==c?c="000000":"G"==c&&(c="000000000");e!=c&&(a=a.slice(0,-1)+c);var f;e=0;10>=b&&(c=a.match(/(-?[0-9]+)B([0-9]*)$/))&&
(a=c[1],e=35-((c[2]||35)&255));if((b&&10!=b?16==b?null!==a.match(/^-?[0-9a-f]+$/i):8==b?null!==a.match(/^-?[0-7]+$/):2==b&&null!==a.match(/^-?[01]+$/):null!==a.match(/^[+-]?[0-9]+$/))&&!isNaN(f=parseInt(a,b))){e&&(0>f&&(f+=Math.pow(2,36)),f=0<e?f*Math.pow(2,e):Math.trunc(f/Math.pow(2,-e)));var g=f}}return g}
function C(a,b,c,d,e){d=void 0===d?0:d;var f=void 0===f?0:f;var g="",h="",k=-1;c||(c=a.fa||10);d&&(k=Math.ceil(d/Math.log2(c)));if(void 0==e)switch(c){case 8:e="0o";break;case 16:e="0x";break;case 10:h=".";default:e=""}isNaN(b)||"number"!=typeof b?(b=void 0,e=h=""):(0>b&&-1<b&&(b=-1),d&&(0>b&&(b+=Math.pow(2,d)),b>=Math.pow(2,d)&&(k=Math.ceil(Math.log(b)/Math.log(c)))));for(a=f||-1;k--;){a||(g=","+g,a=f);if(void 0==b){if(g="?"+g,0>k)break}else if(d=b%c,b=Math.trunc(b/c),d+=0<=d&&9>=d?48:55,g=String.fromCharCode(d)+
g,!b&&0>k)break;a--}return e+g+h}function wa(a,b){var c=a/F|0,d=b/F|0;return(a&b)==(b|0)&&(c&d)==d}var F=Math.pow(2,32);z.NumIO=ua;function xa(){this.Ua={};for(var a=0;22>a;a++)this.Ua["ACDFHGMNSTWYbdfjcsoXx%"[a]]=null}v(xa,ua);function ya(a,b,c){a.Ua[b]||(a.Ua[b]=c)}l=xa.prototype;l.flush=function(){var a=za;za="";this.Ma(a)};function Aa(a,b){var c=a,d=a.lastIndexOf("/");0<=d&&(c=a.substr(d+1));d=c.indexOf("&");0<d&&(c=c.substr(0,d));b&&(d=c.lastIndexOf("."),0<d&&(c=c.substring(0,d)));return c}
l.Je=function(){var a=ma.apply(0,arguments);if(void 0===a[0])a=new Date(Date.now());else if("string"===typeof a[0]){var b=a[0];0>b.indexOf(":")?b+=" "+(a[1]||"00:00:00 UTC"):b.match(/^[0-9][0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9] [0-9][0-9]:[0-9][0-9]:[0-9][0-9]$/)&&(a[1]||(b+=" UTC"));a=new Date(b)}else a=void 0===a[1]?new Date(a[0]):new Date(Date.UTC.apply(Date,ba(a)));return a};
l.Ma=function(a,b){var c=a.lastIndexOf("\n");b?0<=c&&(b=Date.now(),Ba||(Ba=b),a=((b-Ba)/1E3).toFixed(3)+": "+a):(0<=c&&(console.log(za+a.substr(0,c)),za="",a=a.substr(c+1)),Ba=null);za+=a;return a.length};function G(a,b,c){a.Ma(b+"\n",c)}l.u=function(a){return this.Ma(this.L.apply(this,[a].concat(ba(ma.apply(1,arguments)))))};
l.L=function(a){var b=ma.apply(1,arguments);if(!b||!b.length)return a;var c="",d=a.split(/%([-+ 0#]*)([0-9]*|\*)(\.[0-9]+|)([bwhlL]?)([A-Za-z%])/),e=0,f;for(f=0;f<d.length-6;f+=6){c+=d[f];var g=d[f+5];if(void 0===this.Ua[g])c+="%"+d[f+1]+d[f+2]+d[f+3]+d[f+4]+g;else{if(e<b.length){var h=b[e];"%"!=g&&e++}else h=b[b.length-1];var k=d[f+1],n=0<=k.indexOf("#"),p=0<=k.indexOf("0"),q=d[f+2];"*"==q?(q=h,h=e<b.length?b[e++]:b[b.length-1]):q=+q||0;var r=d[f+3];r=r?+r.substr(1):-1;var w=d[f+4],x=null,u=0,A=
"";var t=0<="ACDFHGMNSTWY".indexOf(g)&&"object"!=typeof h?this.Je(h):h;switch(g){case "C":h=n?"#":"";c+=isNaN(t.getTime())?void 0:this.L(this.L("%%%sW, %%%sF %%%sD, %%%sY",h),t);continue;case "D":h=n?t.getUTCDate():t.getDate();g="d";break;case "A":case "G":case "H":h=n?t.getUTCHours():t.getHours();"A"==g?(h=12>h?"am":"pm",g="s"):("G"==g&&(h=h?12<h?h-12:h:12),g="d");break;case "F":case "M":h=n?t.getUTCMonth():t.getMonth();"F"==g?(h=Ca[h],g="s"):(h++,g="d");break;case "N":h=n?t.getUTCMinutes():t.getMinutes();
g="d";break;case "S":h=n?t.getUTCSeconds():t.getSeconds();g="d";break;case "T":h=n?"#":"";c+=isNaN(t.getTime())?void 0:this.L(this.L("%%%sY-%%%s02M-%%%s02D %%%s02H:%%%s02N:%%%s02S",h),t);continue;case "W":h=Da[n?t.getUTCDay():t.getDay()];g="s";break;case "Y":h=n?t.getUTCFullYear():t.getFullYear(),0<r&&(h%=Math.pow(10,r),r=-1),g="d"}switch(g){case "b":c+=h?"true":"false";break;case "d":h=Math.trunc(h),0<=r&&(p=!0,q<r&&(q=r),r=-1);case "f":h=+h;t=h+"";0<=r&&(t=h.toFixed(r));t.length<q&&(p?(0>h&&(q--,
t=t.substr(1)),t=("0".repeat(q)+t).slice(-q),0>h&&(t="-"+t)):t=(" ".repeat(q)+t).slice(-q));c+=t;break;case "j":c+=JSON.stringify(h,null,q||void 0);break;case "c":h="string"==typeof h?h[0]:String.fromCharCode(h);case "s":if(void 0!=h)for("string"!=typeof h&&(h=h.toString()),0<=r&&(h=h.substr(0,r));h.length<q;)h=0<=k.indexOf("-")?h+" ":" "+h;c+=h;break;case "o":u=8,n&&(A="0");case "X":x=Fa;case "x":t="";u||(u=16);!A&&n&&(A="0x");x||(x=Ga);h=Math.trunc(h);0<=r&&(p=!0,q<r&&(q=r));p&&!q&&("b"==w?q=2:
"h"==w||"w"==w?q=4:"l"==w?q=8:(q=Math.abs(h),q=255>=q?2:65535>=q?4:4294967295>=q?8:9),q+=A.length);q-=A.length;do n=h&u-1,h>>>=16==u?4:3,p||!t||n||h?t=x[n]+t:(A&&(t=A+t,A=""),0<q&&(t=" "+t));while(0<--q||h);c+=A+t;break;case "%":c+="%";break;default:c=this.Ua[g]?c+this.Ua[g](g,k,q,r,h):c+("(unimplemented sprintf type: %"+g+")")}}}return c+=d[f]};var za="",Ba=null,Ga="0123456789abcdef",Fa="0123456789ABCDEF",Da="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Ca="January February March April May June July August September October November December".split(" ");
z.StdIO=xa;function Ha(a){xa.call(this);this.ca={};this.oa=0;this.X=this;a&&(this.X.oa=0,this.X.Ja=[],this.X.Fa=0,this.X.jb={},this.X.Wg=!1)}var Ia;v(Ha,xa);l=Ha.prototype;l.Na=function(a,b){var c=this,d=this;switch(a){case Ja.kd:b.onclick=function(){var e=c.Ta(Ja.kb,!0);e&&(e.value="")};break;case Ja.kb:Ka(b),b.addEventListener("keydown",function(e){La(d,e,!0)}),b.addEventListener("keypress",function(e){La(d,e)})}};function Ma(a,b){var c=Na.fc;a.X.jb[c]||(a.X.jb[c]=[]);a.X.jb[c].push(b)}
function Oa(a,b,c){var d=!1;"boolean"==typeof b&&(d=b,b=c.shift());if(b=a.L.apply(a,[b].concat(ba(c))))G(a,b),d||alert(b)}function Ka(a){a.setAttribute("autocapitalize","off");a.setAttribute("autocomplete","off");a.setAttribute("autocorrect","off");a.setAttribute("spellcheck","false");a.value=""}l.error=function(a,b){Oa(this,"%s",this.L.apply(this,[a].concat(ba(b))))};l.Ta=function(a){return this.ca[a]};
function Pa(a){var b=window;if(b){do{for(var c=0;c<Qa.length;c++){var d=Qa[c];d=d?d+a[0].toUpperCase():a[0];d+=a.substr(1);if(d in b)return d}if(0>a.indexOf("screen"))break;a=a.replace("screen","Screen")}while(1)}return null}function Ra(a,b){return a.v.bindings&&a.v.bindings[b]}function Sa(a){if(a=a.ca[Ta])var b=a.textContent;return b}function Ua(a,b,c){a=+a||0;a<b&&(a=b);a>c&&(a=c);return a}
function H(a,b,c,d){a=a.v[b];void 0===a?a=c:(d&&void 0!==d[a]&&(a=d[a]),d=typeof c,typeof a!=d&&("boolean"==d?a=!!a:"number"==typeof c&&(a=+a)));return a}function Va(a,b,c){if("string"==typeof b)return Wa(b,function(d,e,f,g){var h=!1;if(g){h=0>g;var k=d}else{if(4!=f)return;try{var n=JSON.parse(e)}catch(p){k=p.message||"unknown error"}}k&&Oa(a,h,"Unable to load %s media (error %d: %s)");c(n)}),!1;c(b);return!0}
function Wa(a,b){var c=0,d=null,e=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");e.onreadystatechange=function(){4!==e.readyState?b(a,d,e.readyState,c):(d=e.responseText,200==e.status||!e.status&&d.length&&"file:"==(window?window.location.protocol:"file:")||(c=e.status||-1),b(a,d,e.readyState,c))};e.open("GET",a,!0);e.send()}
function Xa(a){if(void 0===Ya.yb){var b=!1;if(window)try{window.localStorage.setItem(Ya.bb,Ya.bb),b=window.localStorage.getItem(Ya.bb)==Ya.bb,window.localStorage.removeItem(Ya.bb)}catch(c){G(a,c.message),b=!1}Ya.yb=b}return!!Ya.yb}function Za(a,b){b=void 0===b?0:b;1<b&&b%2&&b--;b=b||a.oa;return-1==(b|1)||wa(a.X.oa,b)?!0:!1}
function $a(a){if(window){var b=window.navigator.userAgent;return"iOS"==a&&(!!b.match(/(iPod|iPhone|iPad)/)||"MacIntel"===window.navigator.platform&&1<window.navigator.maxTouchPoints)||"MSIE"==a&&!!b.match(/(MSIE|Trident)/)||0<=b.indexOf(a)}return!1}function ab(a){var b=null;if(Xa(a)){var c;if(window)try{(c=window.localStorage.getItem(a.Y))&&(b=JSON.parse(c))}catch(d){G(a,d.message)}}return b}
function La(a,b,c){b=b||window.event;var d=b.which||b.keyCode;if(d){var e=a.X,f=b.target;if(c){a=!1;var g;c=f.value;var h=c.lastIndexOf("\n");d==I.bc&&f.selectionStart<=h+1&&(a=!0);d==I.ke?(a=!0,0<e.Fa&&(g=e.Ja[--e.Fa])):d==I.rd&&(a=!0,e.Fa<e.Ja.length&&(g=e.Ja[++e.Fa]||""));a&&b.preventDefault();void 0!=g&&(f.value=c.substr(0,h+1)+g)}else d=String.fromCharCode(d),g=f.value,c=g.lastIndexOf("\n"),f.selectionStart<=c&&f.setSelectionRange(g.length,g.length),b.stopPropagation(),"@"==d&&0<e.Fa&&c+1==g.length&&
(f.value+=e.Ja[--e.Fa],d="\r"),"\r"==d&&(b.preventDefault(),g=f.value+="\n",f.blur(),f.focus(),(b=bb(a,g.slice(g.lastIndexOf("\n",g.length-2)+1,-1)||""))&&G(a,b.replace(/\n$/,""),!1))}}function cb(a){return"true"==a||"on"==a?!0:"false"==a||"off"==a?!1:void 0}
function db(a,b){if(void 0!=b){var c=a.X;try{if(b=b.trim())c.Fa<c.Ja.length&&b==c.Ja[c.Fa]?c.Fa++:(c.Ja.push(b),c.Fa=c.Ja.length);var d=b.split(" "),e=d[0],f=a.X.jb[Na.fc];switch(e[0]){case "m":if("?"==e[1]){var g="";eb.forEach(function(q){g+=q+"\n"});g&&(g="message commands:\n"+g);break}g="";var h=void 0;e=d[d.length-1].toLowerCase();var k=cb(e);void 0!=k&&d.pop();1>=d.length&&(void 0!=k&&(h=k,k=void 0),d[1]="all");"all"==d[1]&&(d=Object.keys(J));for(f=1;f<d.length;f++){e=d[f];var n=J[e];if(!n){g+=
"unrecognized message: "+e+"\n";break}void 0!=k&&fb(a,n,k);if(void 0==h||h==Za(a,n))g+=a.L("%8s: %b\n",e,Za(a,n))}Za(a,y.Va)&&(g+="all messages will be buffered until buffer is turned off\n");g||(g="no messages\n");break;case "?":g="",gb.forEach(function(q){g+=q+"\n"}),g&&(g="default commands:\n"+g);default:if(d.unshift(b),f)for(a=0;a<f.length;a++){var p=f[a](d);if(void 0!=p){g=g?g+p:p;break}}}}catch(q){g="error: "+q.message+"\n"}}return g}
function bb(a,b){b=void 0===b?"?":b;if(b){var c="";b=b.split(/(?:\n|;\s*)/);for(var d=0;d<b.length;d++)c+=db(a,b[d])}return c}l.Ma=function(a,b){void 0==b&&(b=Za(this,y.Va));if(!b){var c=this.Ta(Ja.kb,!0);if(c)return c.value.substr(-a.length)!=a&&(c.value+=a,8192<c.value.length&&(c.value=c.value.substr(c.value.length-4096)),c.scrollTop=c.scrollHeight,$a("iOS")||c.setSelectionRange(c.value.length,c.value.length)),a.length}return xa.prototype.Ma.call(this,a,b)};
l.u=function(a){var b=ma.apply(1,arguments),c=0;"number"==typeof a&&(c=a,a=b.shift());return Za(this,c)?xa.prototype.u.call.apply(xa.prototype.u,[this,a].concat(ba(b))):0};function hb(a,b){if(Xa(a)){b=JSON.stringify(b);try{window.localStorage.setItem(a.Y,b)}catch(c){G(a,c.message)}}}function ib(a,b,c){(a=a.ca[b])&&a.textContent!=c&&(a.textContent=c)}
function fb(a,b,c){var d=!1;c?(c=a.X.oa,a.X.oa=(c|b)+(c/F|0|b/F|0)*F):(d=wa(a.X.oa,y.Va)&&wa(b,y.Va),c=a.X.oa,a.X.oa=(c&~b)+((c/F|0)&~(b/F|0))*F);d&&a.flush()}
var Ja={kd:"clear",kb:"print"},gb=["\u2191 \u2193\t\trecall commands","@\t\trepeat last command","m?\t\tmessage commands"],eb=["m\t\tdisplay all messages","m on\t\tdisplay all active messages","m off\t\tdisplay all inactive messages","m all [on|off]\tturn all messages on or off","m ... [on|off]\tturn selected messages on or off"],J={all:y.$b,buffer:y.Va},Na={fc:"command"},jb={ic:13,xb:65,ac:66,cc:67,kc:68,E:69,mc:70,oc:71,pc:72,qc:73,rc:74,wc:75,yc:76,Bc:77,Cc:78,Dc:79,Ec:80,Q:81,Fc:82,Hc:83,Ic:84,
Kc:85,Lc:86,Nc:87,Pc:88,Rc:89,Jb:90,a:97,b:98,c:99,d:100,e:101,f:102,Vg:103,Xg:104,Yg:105,Zg:106,k:107,$g:108,ah:109,n:110,bh:111,p:112,q:113,r:114,dh:115,t:116,gh:117,hh:118,w:119,x:120,y:121,z:122},I={bc:8,fe:9,Ld:10,ic:13,ce:16,md:17,gd:18,Gg:19,zb:20,If:27,ee:32,Jg:33,Ig:34,Hf:35,cg:36,Ac:37,ke:38,Eb:39,$f:39,rd:40,Xf:44,Kg:44,dg:45,Gf:46,Zf:46,bg:47,ZERO:48,ONE:49,je:50,ge:51,Dd:52,Cd:53,de:54,be:55,ud:56,Qd:57,Ad:59,zd:61,xb:65,ac:66,cc:67,kc:68,E:69,mc:70,oc:71,pc:72,qc:73,rc:74,wc:75,yc:76,
Bc:77,Cc:78,Dc:79,Ec:80,Q:81,Fc:82,Hc:83,Ic:84,Kc:85,Lc:86,Nc:87,Pc:88,Rc:89,Jb:90,ec:91,Yf:91,Wf:92,Ng:93,ag:93,hg:96,yg:96,Vf:96,ig:97,wg:97,jg:98,vg:98,kg:99,Bg:99,lg:100,zg:100,mg:101,sg:101,ng:102,Dg:102,og:103,xg:103,pg:104,Fg:104,qg:105,Cg:105,Ag:106,rg:107,Eg:109,tg:110,ug:111,Jf:112,Nf:113,Of:114,Pf:115,Qf:116,Rf:117,Sf:118,Tf:119,Uf:120,Kf:121,Lf:122,Mf:123,Rd:144,$d:145,yd:173,ae:186,vd:187,Ef:188,nd:189,Hg:190,Qg:191,Cf:192,eg:219,Df:220,Mg:221,Lg:222,xd:224,fg:901,Mc:1E3},kb={},lb=(kb[I.Ad]=
I.ae,kb[I.zd]=I.vd,kb[I.yd]=I.nd,kb[I.xd]=I.ec,kb),mb={Ac:1,Eb:2,gg:3},K={},nb=(K[I.bc]="\b",K[I.fe]="\t",K[I.Ld]="\n",K[I.ic]="\r",K[I.ee]=" ",K[I.ZERO]="0",K[I.ONE]="1",K[I.je]="2",K[I.ge]="3",K[I.Dd]="4",K[I.Cd]="5",K[I.de]="6",K[I.be]="7",K[I.ud]="8",K[I.Qd]="9",K[I.xb]="A",K[I.ac]="B",K[I.cc]="C",K[I.kc]="D",K[I.E]="E",K[I.mc]="F",K[I.oc]="G",K[I.pc]="H",K[I.qc]="I",K[I.rc]="J",K[I.wc]="K",K[I.yc]="L",K[I.Bc]="M",K[I.Cc]="N",K[I.Dc]="O",K[I.Ec]="P",K[I.Q]="Q",K[I.Fc]="R",K[I.Hc]="S",K[I.Ic]=
"T",K[I.Kc]="U",K[I.Lc]="V",K[I.Nc]="W",K[I.Pc]="X",K[I.Rc]="Y",K[I.Jb]="Z",K[I.Ac]="Left",K[I.Eb]="Right",K),Qa=["","moz","ms","webkit"],ob={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",
crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",
forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",
lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",
moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",
seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},Ya={yb:void 0,bb:"PCjs.localStorage"};z.WebIO=Ha;
function L(a,b,c,d){a=void 0===a?"default":a;b=void 0===b?a:b;c=void 0===c?{}:c;d=void 0===d?[]:d;Ha.call(this,a==b);this.Y=a;this.S=b;pb[this.Y]||(pb[this.Y]={});pb[this.Y][this.S]&&this.u("warning: machine configuration contains multiple '%s' devices\n",this.S);pb[this.Y][this.S]=this;this.id=this.Y==this.S?this.Y:this.Y+"."+this.S;qb.push(this);this.X=rb(this,this.Y);this.ready=!0;sb(this,c,d);this.Ka={};this.Oc=[]}v(L,Ha);l=L.prototype;l.Kb=function(){};l.Lb=function(){};
function sb(a,b,c){c=b.overrides||c;if(c.length){var d,e=Ia;if(!e){e={};if(window){d||(d=window.location.search.substr(1));for(var f,g=/\+/g,h=/([^&=]+)=?([^&]*)/g;f=h.exec(d);)e[decodeURIComponent(f[1].replace(g," ")).trim()]=decodeURIComponent(f[2].replace(g," ")).trim()}Ia=e}d=e;for(var k in d)0<=c.indexOf(k)&&(e=d[k],f=va(e,10),void 0==f&&("true"==e?f=!0:"false"==e?f=!1:(f=e,e='"'+e+'"')),b[k]=f,G(a,"overriding "+a.S+" property '"+k+"' with "+e))}a.v=b;c=b.bindings;c=void 0===c?{}:c;if("undefined"!=
typeof document){a.v.ca||(a.v.ca=c);(k=Array.isArray(c))?0>c.indexOf("container")&&c.push("container"):c.container||(c.container=a.S);for(var n in c){e=c[n];if(k)n=e;else if(e.match(/^[0-9]+$/)){d=+e;a.ca[n]=[];do{e=n+d++;e=document.getElementById(e);if(!e)break;a.ca[n].push(e)}while(1);continue}if(d=document.getElementById(e))a.ca[n]=d,a.Na(n,d)}}b=void 0===b?{}:b;a.version=3;if(a.version){n="";var p;a.Y!=a.S&&(p=rb(a,a.Y).version)&&p!=a.version&&(n="Machine");n||(p=b.version)&&p>a.version&&(n="Config");
n&&(p=a.L("%s Device version (%3.2f) incompatible with %s version (%3.2f)",b.Sg,a.version,n,p),a.error("%s\n\nClearing your browser's cache may resolve the issue.",p))}}function M(a,b,c,d){a.Ka[b]={get:c.bind(a),set:d?d.bind(a):null}}function tb(a,b,c){a.Ka[b]&&(a.Ka[c]=a.Ka[b])}function ub(a,b){var c;try{var d=pb[a.Y];if(d)for(c in d){var e=d[c];if(e.S!=e.Y&&!b(e))return!1}return!0}catch(f){a.u("error while enumerating device '%s': %s\n",c,f.message)}return!1}
l.Ta=function(a,b){b=void 0===b?!1:b;if(a){var c=Ha.prototype.Ta.call(this,a,b);if(void 0===c&&b){b=pb[this.Y];for(var d in b)if(c=b[d].ca[a])break;c||(c=null);this.ca[a]=c}}return c};function rb(a,b,c){var d=b,e=a.Y,f=e.indexOf(".");0<f&&(e=e.substr(0,f),b=b.substr(f+1));b=(f=pb[e])&&f[b]||null;if(!b){for(f=0;f<qb.length;f++)if(qb[f].id===d){b=qb[f];break}if(!b&&(void 0===c||c))throw Error(a.L('no "%s" device',d));}return b}
function O(a,b,c){var d=null,e=pb[a.Y];if(e)for(var f in e)if(e[f].v["class"]==b){if(d){d=null;break}d=e[f]}if(!d&&(void 0===c||c))throw Error(a.L("no %s device",b));return d}function vb(a,b){var c=rb(a,a.Y);return c&&c.v&&c.v[b]||a.v[b]}function wb(a,b){return(a=a.Ka[b])&&a.get()}function xb(a){return a==a.X&&a.ready?ub(a,function(b){return xb(b)}):a.ready}function yb(a,b){b=void 0===b?a.ready:b;a.ready=b;if(xb(a)){for(;b=a.Oc.pop();)b();a!=a.X&&yb(a.X)}}
function zb(a,b){if(xb(a))return b(),!0;a.Oc.push(b);return!1}l.bd=function(){};l.u=function(a){var b=ma.apply(1,arguments);return"number"==typeof a&&Za(this,a)&&(void 0===this.aa&&(this.aa=O(this,"Debugger",!1)),this.aa&&this.aa.bd(a),this.X.oa&y.Zb&&(void 0===this.I&&(this.I=O(this,"CPU")),this.I))?(a=b.shift(),Ha.prototype.u.call(this,"%#06x: %s.%s\n",this.I.Rb,this.S,this.L.apply(this,[a].concat(ba(b))).trim())):Ha.prototype.u.call.apply(Ha.prototype.u,[this,a].concat(ba(b)))};
function Ab(a,b){(a=pb[a.Y])&&delete a[b]}function Bb(a,b,c){(a=a.Ka[b])&&a.set&&a.set(c)}"undefined"!=typeof window&&(window.PCjs||(window.PCjs={}),window.PCjs.Machines||(window.PCjs.Machines={}),window.PCjs.Components||(window.PCjs.Components=[]));var pb="undefined"!=typeof window?window.PCjs.Machines:{},qb="undefined"!=typeof window?window.PCjs.Components:[];y.Zb=1;y.hd=2;y.nc=4;y.Md=8;y.Db=16;y.jd=32;y.Kd=64;y.ab=128;y.Cb=256;y.ld=512;y.Nd=1024;y.INT=2048;y.Jc=4096;y.me=8192;y.Od=16384;y.Zd=32768;
y.pd=65536;y.Bd=131072;y.lb=262144;y.he=524288;y.lc=1048576;y.Ha=2097152;y.xc=4194304;y.Pd=8388608;y.ie=16777216;y.Fd=33554432;y.mb=67108864;y.wd=134217728;y.Ed=268435456;y.Ff=4294967296;J.addr=y.Zb;J.bus=y.hd;J.fault=y.nc;J.memory=y.Md;J.ports=y.Db;J.chips=y.jd;J.kbd=y.Kd;J.serial=y.ab;J.misc=y.Cb;J.cpu=y.ld;J.mmu=y.Nd;J["int"]=y.INT;J.trap=y.Jc;J.video=y.me;J.monitor=y.Od;J.screen=y.Zd;J.disk=y.pd;J.file=y.Bd;J.time=y.lb;J.timer=y.he;J.event=y.lc;J.input=y.Ha;J.key=y.xc;J.mouse=y.Pd;J.touch=y.ie;
J.info=y.Fd;J.warn=y.mb;J.error=y.wd;J.halt=y.Ed;z.Device=L;
function Cb(a,b,c){L.call(this,a,b,c);this.oa=y.Ha;this.T=this.K=null;this.time=O(this,"Time");this.X=O(this,"Machine");this.$=H(this,"drag",!1);this.R=H(this,"scroll",!1);this.Z=H(this,"hexagonal",!1);this.l=H(this,"releaseDelay",0,void 0);this.m=!1;a=this.v.map;this.h=this.j=null;if(a)if(a.length)this.h=a;else{this.j={};b=Object.keys(a);for(var d=0;d<b.length;d++){var e=[],f=b[d],g=a[f];"string"==typeof g?g=[g]:void 0==g.length&&(e=g.grid,g=g.keys,"string"==typeof g&&(g=[g]));this.j[f]={keys:g,
grid:e,state:0}}}this.J=[];this.M=[];this.i=this.O=null;(a=this.ca[Db])&&Eb(this,a,this.Ta(c.focusBinding,!0),this.v.location);this.qa()}v(Cb,L);function Fb(a,b){a.K=b}function Gb(a,b,c){for(var d=0;d<a.J.length;d++){var e=a.J[d];e.id===b&&e.ob(b,c)}}
function Eb(a,b,c,d){d=void 0===d?[]:d;if(d.length||a.h||a.j){var e={};e.Af=d[0]||0;e.Bf=d[1]||0;e.eb=d[2]||b.clientWidth;e.nb=d[3]||b.clientHeight;e.pb=d[4]||1;e.ub=d[5]||1;e.xe=d[6]||b.naturalWidth||e.eb;e.ze=d[7]||b.naturalHeight||e.nb;e.ed=d[8]||0;e.fd=d[9]||0;e.we=d[10]||0;e.ye=d[11]||0;a.h?(e.rb=a.h.length,e.fb=a.h[0].length):(e.fb=e.pb,e.rb=e.ub,e.pb=e.ub=0);e.Zc=e.eb/(e.fb+e.fb*e.pb)|0;e.$c=e.nb/(e.rb+e.rb*e.ub)|0;e.ve=e.Zc*e.pb|0;e.ad=e.$c*e.ub|0;e.ib=e.wb=-1;Hb(a,b,e);Ib(a,b,e);a.time&&
a.l&&(a.W=Jb(a.time,"timerInputRelease",function(){0>e.ib&&0>e.wb&&Kb(a,-1,-1)}))}if(a.h||a.j)a.time&&a.l&&(a.ba=Jb(a.time,"timerKeyRelease",function(){Lb(a)})),a.o=0,a.H="",a.s=[],d=b,c&&(d=c,a.i||"BUTTON"!=c.nodeName||(d=document,a.i=c,Mb(a,b),a.O=b)),Mb(a,d),a.i||(a.i=d)}function Nb(a){a.l?Ob(a.time,a.ba,a.l):Lb(a)}
function Pb(a,b,c,d,e){if(a=a.ca[b]){for(b=0;b<a.options.length&&a.options[b].text!=c;b++);void 0==a.options.length&&(b=document.createElement("option"),b.text=c,b.value=d,(void 0===e?0:e)&&a.childNodes[0]?a.insertBefore(b,a.childNodes[0]):a.appendChild(b))}}
function Mb(a,b){function c(e,f,g){var h=document.activeElement;a.u(y.xc+y.lc,"%s.onKey%s(%d): %5.2f (%s)\n",h.id||h.nodeName,e,f,Date.now()/1E3%60,void 0!=g?g?"used":"unused":"ignored")}function d(e,f){e=document.activeElement;return a.i&&e!=a.i&&e!=a.O?null:f||window.event}b.addEventListener("keydown",function(e){if(e=d(this,e)){var f=e.which||e.keyCode,g=Qb(a,f,!0,e);c("Down",f,g);g&&e.preventDefault()}});b.addEventListener("keypress",function(e){if(e=d(this,e)){var f=e.which||e.charCode,g=Qb(a,
f);c("Press",f,g);g&&e.preventDefault()}});b.addEventListener("keyup",function(e){if(e=d(this,e)){var f=e.which||e.keyCode,g=Qb(a,f,!1,e);c("Up",f);g&&e.preventDefault();"TEXTAREA"==b.nodeName&&(b.value="")}})}
function Hb(a,b,c){b.addEventListener("mousedown",function(d){if(!a.m){var e=a.i;if(e){var f=window.scrollX,g=window.scrollY;e.focus();window.scrollTo(f,g)}d.button||Rb(a,b,Sb,d,c)}});b.addEventListener("mousemove",function(d){a.m||Rb(a,b,Tb,d,c)});b.addEventListener("mouseup",function(d){a.m||d.button||Rb(a,b,Ub,d,c)});b.addEventListener("mouseout",function(d){a.m||(0>c.ib?Rb(a,b,Tb,d,c):Rb(a,b,Ub,d,c))})}
function Ib(a,b,c){b.addEventListener("touchstart",function(d){a.R&&(a.m=!0);Rb(a,b,Sb,d,c)});b.addEventListener("touchmove",function(d){Rb(a,b,Tb,d,c)});b.addEventListener("touchend",function(d){Rb(a,b,Ub,d,c)})}
function Qb(a,b,c,d){if(void 0!=c){var e=lb[b]||b;var f=nb[b];var g=Vb[e];d=d&&d.location==mb.Eb;g&Wb&&d&&(g>>=1);g&&(g&Xb&&(c=!(a.g&g)),a.g=c?a.g|g:a.g&~g,Gb(a,e,c))}else f=String.fromCharCode(b).toUpperCase(),b>=jb.xb&&b<=jb.Jb?a.g&(Yb|Zb)||(a.g|=Zb,Gb(a,I.zb,!0)):b>=jb.a&&b<=jb.z&&a.g&Zb&&(a.g&=~Zb,Gb(a,I.zb,!1));if(a.h){if(void 0!=c)return!1;for(e=0;e<a.h.length;e++)for(g=a.h[e],d=0;d<g.length;d++)if(0<=g[d].split("|").indexOf(f))return a.o?16>a.s.length&&a.s.push(b):(a.o=1,a.H=f,Kb(a,d,e),Gb(a,
f,!0),Nb(a)),!0}if(a.j){if(void 0==c)return!0;b=Object.keys(a.j);for(e=0;e<b.length;e++)if(g=b[e],0<=a.j[g].keys.indexOf(f))return Gb(a,g,c),a.j[g].state=c?1:0,!0}return!1}function Lb(a){1==a.o?(a.o++,Gb(a,a.H,!1),a.H="",Kb(a,-1,-1),Nb(a)):(a.o=0,a.s.length&&Qb(a,a.s.shift()))}Cb.prototype.qa=function(){this.g=0;this.N=this.U=-1};
function Rb(a,b,c,d,e){var f=-1,g=-1,h=!1,k=-1,n=-1;if(c<Ub){d=d||window.event;d.targetTouches&&d.targetTouches.length?(k=d.targetTouches[0].clientX,n=d.targetTouches[0].clientY,h=1<d.targetTouches.length):(k=d.clientX,n=d.clientY);var p=d.target.getBoundingClientRect();k-=p.left;n-=p.top;k=e.xe/b.offsetWidth*k|0;n=e.ze/b.offsetHeight*n|0;var q=k-e.Af;var r=n-e.Bf;var w=p=!1;var x=k>=e.ed&&k<e.ed+e.we&&n>=e.fd&&n<e.fd+e.ye;if(0<=q&&q<e.eb&&0<=r+e.ad||x)if(h||a.R||d.preventDefault(),0<=q&&q<e.eb&&
0<=r&&r<e.nb){w=!0;d=e.eb/e.fb|0;var u=e.nb/e.rb|0,A=q/d|0,t=r/u|0;!a.Z||t&1||(q-=d>>1,A=q/d|0,A==e.fb-1&&(q=-1));u=t*u+(e.ad>>1);q-=A*d+(e.ve>>1);r-=u;0<=q&&q<e.Zc&&0<=r&&r<e.$c&&(f=A,g=t,p=!0)}}q=q||0;r=r||0;d=b.offsetWidth;b=b.offsetHeight;if(c==Sb||c==Ub)for(A=0;A<a.M.length;A++)t=a.M[A],c==Ub?t.ob(t.id,!1):(u=r/(b/t.Ug|0)|0,(q/(d/t.Tg|0)|0)==t.ih&&u==t.jh&&t.ob(t.id,!0));if(!h)if(c==Sb)e.ib=k,e.wb=n,w?(Kb(a,f,g),p&&a.l&&Ob(a.time,a.W,a.l,!0)):x&&a.X.pa();else if(c==Tb)0<=e.ib&&0<=e.wb&&a.$?Kb(a,
f,g):a.K&&a.K(f,g);else if(c==Ub){if(c=a.l)c=a.time,f=a.W,c=c.g&&0<f&&f<=c.h.length?0<=c.h[f-1].Aa:!1;c||Kb(a,-1,-1);e.ib=e.wb=-1}else G(a,"unrecognized action: "+c)}function Kb(a,b,c){if(b!=a.N||c!=a.U)a.N=b,a.U=c,a.T&&a.T(b,c)}var Sb=1,Tb=2,Ub=3,Db="surface",Yb=3,Wb=170,Zb=512,Xb=3584,$b={},Vb=($b[I.ce]=2,$b[I.md]=8,$b[I.gd]=32,$b[I.ec]=128,$b[I.zb]=Zb,$b[I.Rd]=1024,$b[I.$d]=2048,$b);z.Input=Cb;
function ac(a,b,c){L.call(this,a,b,c,["color","backgroundColor"]);a=this.ca[bc];if(!a)throw Error("LED "+this.v.ca[bc]+" binding for '"+bc+"' missing");b=document.createElement("canvas");if(!b||!b.getContext)throw a.innerHTML="LED device requires HTML5 canvas support",Error("LED device requires HTML5 canvas support");this.ta=Ra(this,bc)+".canvas";b.setAttribute("id",this.ta);this.Ca=a;this.type=Ua(H(this,"type",cc,dc),ec,fc);this.j=gc[this.type][0];this.s=gc[this.type][1];this.width=H(this,"width",
this.j,void 0);this.height=H(this,"height",this.s,void 0);this.l=H(this,"cols",1,void 0);this.M=this.l+H(this,"colsExtra",0,void 0);this.$=H(this,"rows",1,void 0);this.R=this.$+H(this,"rowsExtra",0,void 0);this.da=this.width*this.l;this.U=this.height*this.$;this.o=hc("black",0);this.i=ic(this.v.color)||this.o;this.la=hc(this.i,1,.25);this.ka=hc(this.i,1,2);this.m=ic(this.v.backgroundColor);this.na=H(this,"fixed",!1);this.na||(b.style.width="100%",b.style.height="auto");this.ja=H(this,"hexagonal",
!1);this.sa=H(this,"highlight",!0);this.T=H(this,"persistent",this.type<fc);b.setAttribute("width",this.da.toString());b.setAttribute("height",this.U.toString());b.style.backgroundColor=this.o;a.appendChild(b);this.ha=b.getContext("2d");if(this.H=document.createElement("canvas"))this.H.width=this.ba=this.j*this.l,this.H.height=this.K=this.s*this.$,this.h=this.H.getContext("2d");this.va=(this.R+1)*this.M*4;this.g=Array(this.va);this.wa=this.l<this.M?4*(this.M-this.l):0;this.O=this.N=!1;this.J=this.Z=
0;this.W=-1;var d=this;this.time=O(this,"Time");jc(this.time,function(e){kc(d,!1,e)});lc(d)}v(ac,L);function lc(a){for(var b=a.g,c=0;c<b.length;c+=4){var d=a,e=b,f=c;e[f]=d.type<fc?mc:" ";e[f+1]=d.i==d.o?null:d.i;e[f+2]=0;e[f+3]=nc}a.O=a.N=!0;kc(a,!0)}function oc(a){a.m?(a.h.fillStyle=a.m,a.h.fillRect(0,0,a.ba,a.K)):a.h.clearRect(0,0,a.ba,a.K)}
function kc(a,b,c){b=void 0===b?!1:b;c=void 0===c?0:c;if(a.O||b){if(a.type<fc){var d=0;if(!a.T||b)oc(a);else if(a.J){d=a.l-a.J;var e=a.j*d;a.h.drawImage(a.H,a.j*a.J,0,e,a.K,0,0,e,a.K)}for(var f=e=0;f<a.R;f++){for(var g=0;g<a.l;g++){var h=a.g[e],k=a.g[e+1]||a.o,n=a.sa&&e==a.W;if(a.g[e+3]&nc||n||b){if(g>=d)a:{var p=a,q=h;h=k;var r=g;k=f;var w=n;r=void 0===r?0:r;k=void 0===k?0:k;w=void 0===w?!1:w;var x=0;if(p.ja&&!(k&1)&&(x=p.j>>1,r==p.l-1))break a;if(h&&h!=p.i){w=w?hc(h,1,2):h;var u=hc(h,1,.25)}else w=
w?p.ka:p.i,u=p.la;h=!1;q=q?w:u;w==p.o&&(q=p.m,h=!0);w=r*p.j+x;u=k*p.s;p.T&&(r=r*p.j+x,k*=p.s,p.m?(p.h.fillStyle=p.m,p.h.fillRect(r,k,p.j,p.s)):p.h.clearRect(r,k,p.j,p.s));p.h.fillStyle=q;k=pc[p.type];3==k.length?(p.h.beginPath(),p.h.arc(w+k[0],u+k[1],k[2],0,2*Math.PI),h?(p.h.globalCompositeOperation="destination-out",p.h.fill(),p.h.globalCompositeOperation="source-over"):p.h.fill()):p.h.fillRect(w+k[0],u+k[1],k[2],k[3])}a.g[e+3]=n?a.g[e+3]|nc:a.g[e+3]&~nc}e+=4}e+=a.wa}a.J=0}else{b="";for(d=0;d<a.g.length;d+=
4)b+=a.g[d]||" ",a.g[d+3]&qc&&(b+=".");oc(a);for(f=e=d=0;d<b.length;d++){k=b[d];"."==k&&e&&e--;g=a;n=e;p=f;n=void 0===n?0:n;p=void 0===p?0:p;if(k=rc[k])for(h=0;h<k.length;h++)if(r=g,x=sc[k[h]]){q=(void 0===n?0:n)*r.j;w=(void 0===p?0:p)*r.s;r.h.fillStyle=r.i;r.h.beginPath();if(3==x.length)r.h.arc(q+x[0],w+x[1],x[2],0,2*Math.PI);else for(u=0;u<x.length;u+=2)u?r.h.lineTo(q+x[u],w+x[u+1]):r.h.moveTo(q+x[u],w+x[u+1]);r.h.closePath();r.h.fill()}if(++e==a.l&&(e=0,++f==a.R))break}}a.ha.globalCompositeOperation=
a.m&&a.i!=a.o?"source-over":"copy";a.ha.drawImage(a.H,0,0,a.ba,a.K,0,0,a.da,a.U);a.O=!1;a.W=-1}else a.T||a.N||(!c||!a.Z||c-a.Z>=(1E3/60|0))&&lc(a);a.N=!1;c&&(a.Z=c)}function ic(a){return(a=a||void 0)&&ob[a]||a}
function hc(a,b,c){b=void 0===b?1:b;c=void 0===c?1:c;if(a){var d=[];a=ob[a]||a;var e=16;var f=a.match(/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i);f||(e=10,f=a.match(/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,?\s*(\d+|)\)$/i));if(f){var g;for(g=1;g<f.length;g++)d[g-1]=Number.parseInt(f[g],e);d.length=g-1;e=!0}else e=!1;if(e){a="rgba(";for(e=0;3>e;e++)f=Math.round(d[e]*c),f=0>f?0:255<f?255:f,a+=f+",";a+=(e<d.length?d[e]:b)+")"}}return a}
ac.prototype.xa=function(a){var b=a.shift(),c=a.shift();a=a.shift();if(b==this.i&&c==this.m&&a&&a.length==this.g.length){this.g=a;for(b=0;b<=this.g.length-4;b+=4)this.g[b+1]==this.o&&(this.g[b+1]=null);kc(this,!0);return!0}return!1};ac.prototype.ya=function(a){this.g&&(a.push(this.i),a.push(this.m),a.push(this.g))};
var ec=0,cc=1,fc=3,dc={small:ec,round:cc,square:2,digit:fc},bc="container",mc=0,qc=1,nc=128,tc={},pc=(tc[ec]=[4,4,4],tc[cc]=[16,16,14],tc[2]=[2,2,28,28],tc),gc=[[8,8],[32,32],[32,32],[96,128]],sc={A:[30,8,79,8,67,19,37,19],B:[83,10,77,52,67,46,70,22],C:[77,59,71,100,61,89,64,64],D:[28,91,58,91,69,104,15,104],E:[18,59,28,64,25,88,12,100],F:[24,10,34,21,31,47,18,52],G:[24,56,34,50,60,50,71,56,61,61,33,61],P:[80,102,8]},rc={" ":[],0:"ABCDEF".split(""),1:["B","C"],2:["A","B","D","E","G"],3:["A","B","C",
"D","G"],4:["B","C","F","G"],5:["A","C","D","F","G"],6:"ACDEFG".split(""),7:["A","B","C"],8:"ABCDEFG".split(""),9:"ABCDFG".split(""),A:"ABCEFG".split(""),B:["C","D","E","F","G"],C:["A","D","E","F"],D:["B","C","D","E","G"],E:["A","D","E","F","G"],F:["A","E","F","G"],"-":["G"],".":["P"]};z.LED=ac;
function uc(a,b,c){L.call(this,a,b,c);this.la=H(this,"cyclesMinimum",1E5,void 0);this.va=H(this,"cyclesMaximum",1E9,void 0);this.ba=Ua(H(this,"cyclesPerSecond",1E6,void 0),this.la,this.va);this.T=1E3/60;this.wa=H(this,"updatesPerSecond",2,void 0)||2;this.Za=1E3/this.wa;this.ta=0;this.$a=H(this,"timeLock",!0);this.ka=this.M=0;this.ja=this.l=1;this.sa=this.o=this.ba/1E4/100;this.da=[];this.K=[];this.h=[];this.Z=[];this.na=this.g=this.R=this.H=!1;this.J=this.j=0;a=Pa("requestAnimationFrame");if(!a){a=
"setTimeout";var d=this.T}this.Ca=window[a].bind(window,this.cf.bind(this),d);this.Ya=window[Pa("cancelAnimationFrame")||"clearTimeout"].bind(window);this.W=this.U=this.m=this.i=this.$=0;vc(this)||wc(this,this.ja)}v(uc,L);function jc(a,b){a.da.push(b)}l=uc.prototype;
l.Na=function(a,b){var c=this;switch(a){case xc:b.onclick=function(){yc(c)&&(c.g?zc(c):c.start())};break;case Ac:b.onclick=function(){wc(c,c.l<<1);Bc(c,Cc(c.o))};break;case Dc:b.onclick=function(){Ec(c)};break;case Fc:b.addEventListener("mousedown",function(){c.H=!0}),b.addEventListener("mouseup",function(){vc(c);c.H=!1}),b.addEventListener("mousemove",function(){c.H&&vc(c)}),b.addEventListener("change",function(){c.H=!0;vc(c);c.H=!1})}L.prototype.Na.call(this,a,b)};
function Jb(a,b,c){var d=void 0===d?-1:d;var e=a.h.length+1;a.h.push({id:b,oe:c,qb:d,Aa:-1});0<=d&&Ob(a,e,d);return e}
function Gc(a,b,c,d){var e=0,f=a.o,g=1E6*f;b&&c&&(f=b/(10*c)/100,a.u(y.lb,"calcSpeed(%d cycles, %5.3fms): %5.3fMhz\n",b,c,f),d>a.T&&(1<a.l&&(a.l>>=1,a.u(y.mb,"warning: frame time (%5.3fms) exceeded maximum (%5.3fms), target multiplier now %d\n",d,a.T,a.l)),e=d));a.M=f;a.ka=f/a.sa;b=a.ka/a.l;a.$=g/b/60+1E-8;a.u(y.lb,"nCyclesDepositPerFrame(%5.3f) = nCyclesPerSecond(%d) / nDivisor(%5.3f) / nFramesPerSecond(%d)\n",a.$,g,b,60);return e}
function Hc(a,b){a.U=a.m=b;if(!a.K.length)return a.m=0,a.U;for(var c=0;0<a.m;){if(c<a.K.length){var d=a.K[c++];b=d.ef.call(d,b)||1}else c=b=0;a.m-=b}return a.U-a.m}function Ic(a,b){b=void 0===b?a.U-a.m:b;if(!a.g){if(a.i)for(var c=0;c<a.K.length;c++){var d=a.K[c];d.ff.call(d)}a.i=b}a.i-=b;1>a.i&&(a.R=!0);a.W+=b;a.U=a.m=0;a.g||(a.W=0);return b}
function Jc(a,b){b=void 0===b?0:b;if(b){var c=b;a.i+=b}else for(c=a.i,1>c&&(c=a.i+=a.$),0>c&&(a.u(y.mb,"warning: cycle count dropped below zero: %f\n",c),c=a.i=0),c|=0,b=a.h.length;0<b;b--){var d=a.h[b-1];!(0>d.Aa)&&c>d.Aa&&(c=d.Aa)}return c}function Cc(a){1<=a?a=a.toFixed(2)+"Mhz":(a=Math.round(1E6*a),a=999>=a?a+"Hz":Math.ceil(a/1E3)+"Khz");return a}function Kc(a){a.u(y.lb,"getSpeedCurrent(%5.3fhz)\n",1E6*a.M);return a.g&&a.M?Cc(a.M):"Stopped"}
function yc(a){return a.na?!0:(G(a,"not powered"),!1)}function Lc(a,b){if(1<=b)for(var c=a.h.length;0<c;c--){var d=a.h[c-1];0>d.Aa||(d.Aa-=b,0>=d.Aa&&(d.Aa=-1,d.oe(),0<=d.qb&&Ob(a,c,d.qb)))}}l.pa=function(a){this.na=a;void 0===this.aa&&(this.aa=O(this,"Debugger",!1))&&this.aa.Kb(this,"time","dump time state",this.De)};function Ec(a,b){yc(a)&&(a.g?G(a,"already running"):a.j?zc(a):Mc(a,b))}
l.cf=function(a){a=void 0===a?Date.now():a;this.J=0;if(this.g){var b=Date.now();if(this.O){var c=b-this.N-this.T;c>this.T&&(this.s+=c,this.u(y.mb,"warning: browser throttling detected, compensating by %5.3fms\n",c))}this.N=b;this.s||(this.s=b);this.ha=0;try{this.R=!1;do Lc(this,Ic(this,Hc(this,Jc(this))));while(this.g&&!this.R)}catch(d){G(this,d.message),zc(this)}this.O=Date.now();this.ha&&(this.s+=this.ha,this.N+=this.ha);this.N+=Gc(this,this.W,this.O-this.s,this.O-this.N);this.O-this.ta>=this.Za&&
this.update();for(b=0;b<this.da.length;b++)this.da[b](a);this.J=this.Ca()}};function wc(a,b){if(void 0!==b){if(1>b||!a.H&&0<a.M&&a.M<.9*a.o)b=a.ja;a.l=b;b=a.sa*a.l;a.o!=b&&(a.o=b,Bc(a,Cc(a.o)))}a.s=a.O=0;a.i=a.W=0;Gc(a);for(b=a.h.length;0<b;b--){var c=a.h[b-1];0<=c.qb&&Ob(a,b,c.qb,!0)}}function vc(a){var b=a.ca[Fc];return b?(wc(a,Math.floor((b.value-b.min)/(b.max-b.min)*(a.va-a.la)+a.la)/a.ba|0),!0):!1}
function Ob(a,b,c,d){0<b&&b<=a.h.length&&(b=a.h[b-1],d||0>b.Aa)&&(c=Math.ceil(a.ba*(a.$a?a.ja:a.ka)/1E3*(void 0===c?1E3:c)),a.g&&(c+=Ic(a)),b.Aa=c)}l.start=function(){if(this.g||this.j)return!1;this.g=!0;this.s=this.O=0;this.update(!0);this.J=this.Ca();return!0};function Mc(a,b){b=void 0===b?1:b;a.g||(b&&!a.j&&(a.j=b),a.j&&(a.j--,Lc(a,Ic(a,Hc(a,Jc(a,1)))),a.update(!1),a.j&&setTimeout(function(){Mc(a,0)},0)))}
function zc(a){return a.g?(a.g=!1,Ic(a),a.J&&(a.Ya(a.J),a.J=0),a.update(!0),!0):a.j?(a.j=0,a.update(!0),!0):!1}l.update=function(a){a&&G(this,this.g?"started with "+Cc(this.o)+" target":"stopped");ib(this,xc,this.g?"Halt":"Run");ib(this,Dc,this.j?"Stop":"Step");this.H||Bc(this,Kc(this));for(var b=0;b<this.Z.length;b++){var c=this.Z[b];c.cd.call(c,void 0!=a)}this.ta=Date.now();this.R=!0};function Bc(a,b){ib(a,Nc,b);ib(a,Ac,b)}
l.De=function(){var a=this.L("nCyclesPerSecond: %f\n",this.ba);a+=this.L("nUpdatesPerSecond: %f\n",this.wa);a+=this.L("nTargetMultiplier: %f\n",this.l);return a+=this.L("nCyclesDepositPerFrame: %f\n",this.$)};var xc="run",Ac="setSpeed",Nc="speed",Dc="step",Fc="throttle";z.Time=uc;
function Oc(a,b,c){L.call(this,a,b,c);this.type="static"==this.v.type?Pc:Qc;this.ea=this.v.addrWidth||16;this.m=Math.pow(2,this.ea);this.l=this.m-1|0;this.blockSize=this.v.blockSize||(16<this.ea?4096:1024);this.blockSize>this.m&&(this.blockSize=this.m);this.J=this.m/this.blockSize|0;this.h=Math.log2(this.blockSize)|0;this.i=(1<<this.h)-1;this.j=this.v.dataWidth||8;this.K=Math.pow(2,this.j)-1;this.o=!1!==this.v.littleEndian;this.g=Array(this.J);this.s=0;this.H=null;a=new P(a,b+"[NONE]",{size:this.blockSize,
bus:this.S});for(b=0;b<this.m;b+=this.blockSize)Rc(this,b,this.blockSize,Q.NONE,a);Sc(this,this.type)}v(Oc,L);function Rc(a,b,c,d,e){for(var f=b>>>a.h;0<c&&f<a.g.length;){var g=f*a.blockSize,h=a.blockSize-(b-g);h>c&&(h=c);var k=a.g[f];if(b!=g||h!=a.blockSize||k&&k.type!=Q.NONE)break;k=a.S+"["+C(a,b,16,a.ea)+"]";b=e?e.size==a.blockSize?e:new P(a.Y,k,{type:d,ia:b,size:h,bus:a.S}):new P(a.Y,k,{type:d,ia:b,size:h,bus:a.S});a.g[f]=b;b=g+a.blockSize;c-=h;f++}}
function Tc(a,b){for(var c=Q.Xd,d=0,e=0;e<a.g.length;e++){var f=a.g[e];f&&f.type&c&&(b(f),d++)}return d}function Uc(a,b,c){if(!(b&a.i)){b>>>=a.h;var d=a.g[b];a.g[b]=c}return d}function Vc(a,b,c){a.aa&&a.aa.u(y.nc,"bus fault (%d) at %n\n",c,b);a.H&&a.H(b,c)}l=Oc.prototype;l.pa=function(){void 0===this.aa&&(this.aa=O(this,"Debugger",!1))};l.qa=function(){};l.Ob=function(a){return a&&this.xa(a)?!0:!1};l.gb=function(a){this.ya(a)};
l.xa=function(a){for(var b=0;b<this.g.length;b++){var c=this.g[b];if((this.type==Qc||c.type&Q.Sa)&&c.xa){var d=a.shift();if(!c.xa(d))return!1}}return!0};l.ya=function(a){for(var b=0;b<this.g.length;b++){var c=this.g[b];if((this.type==Qc||c.type&Q.Sa)&&c.ya){var d=[];c.ya(d);a.push(d)}}};l.Qb=function(a){return this.g[a>>>this.h].Qb(a&this.i)};l.Gd=function(a){return this.g[a>>>this.h].Ba(a&this.i)};l.hb=function(a,b){this.g[a>>>this.h].hb(a&this.i,b)};
l.Ga=function(a,b){this.g[a>>>this.h].za(a&this.i,b)};l.sc=function(a){return a&1?this.Ba(a+1&this.l)|this.Ba(a)<<this.j:this.g[a>>>this.h].ma(a&this.i)};l.tc=function(a){return a&1?this.Ba(a)|this.Ba(a+1&this.l)<<this.j:this.g[a>>>this.h].ma(a&this.i)};l.Le=function(a){return(a&this.i)==this.i?this.o?this.tc(a):this.sc(a):this.g[a>>>this.h].ma(a&this.i)};l.uc=function(a,b){a&1?(this.za(a,b>>this.j),this.za(a+1&this.l,b&this.K)):this.g[a>>>this.h].ga(a&this.i,b)};
l.vc=function(a,b){a&1?(this.za(a,b&this.K),this.za(a+1&this.l,b>>this.j)):this.g[a>>>this.h].ga(a&this.i,b)};l.hf=function(a,b){(a&this.i)==this.i?this.o?this.vc(a,b):this.uc(a,b):this.g[a>>>this.h].ga(a&this.i,b)};function Sc(a,b){var c=a.s;a.s+=b;c&&a.s||(a.Ba=a.Gd,a.za=a.Ga,a.type==Qc?(a.ma=a.Le,a.ga=a.hf):a.o?(a.ma=a.tc,a.ga=a.vc):(a.ma=a.sc,a.ga=a.uc))}l.sb=function(a,b){return this.g[a>>>this.h].sb(b)?(Sc(this,1),!0):!1};l.Tb=function(a,b){return this.g[a>>>this.h].Tb(b)?(Sc(this,1),!0):!1};
l.tb=function(a,b){return this.g[a>>>this.h].tb(b)?(Sc(this,-1),!0):!1};l.Vb=function(a,b){return this.g[a>>>this.h].Vb(b)?(Sc(this,-1),!0):!1};var Pc=0,Qc=1;z.Bus=Oc;
function P(a,b,c){L.call(this,a,b,c);this.ia=this.v.addr;this.size=this.v.size;this.type=this.v.type||Q.NONE;this.j=(a=this.v.bus)?rb(this,a):O(this,a="Bus");if(!this.j)throw Error(this.L("unable to find bus '%s'",a));this.g=this.j.j;this.i=Math.pow(2,this.g)-1;this.Z=this.ba=!1;this.l=!1!==this.j.o;this.values=this.$=this.K=this.W=null;a=this.Ra;b=this.Ga;c=this.l?this.Ne:this.Me;var d=this.l?this.kf:this.jf;this.j.type==Pc&&(b=this.uf,c=this.l?this.Id:this.Hd,d=this.vf,8==this.g&&!1!==vb(this,"ArrayBuffer")&&
(this.ba=!0,c=this.l==ra?this.We:this.Xe));switch(this.type){case Q.NONE:this.Ba=this.Pa;this.za=this.Ia;this.ma=this.Oe;this.ga=this.lf;break;case Q.Gc:this.Ba=a;this.za=this.Ia;this.ma=c;this.ga=this.Ia;break;case Q.Sa:this.Ba=a,this.za=b,this.ma=c,this.ga=d}this.M=this.m=0;this.U=this.o=this.T=this.O=this.s=this.H=null;Wc(this,this.v.values);Xc(this)}v(P,L);
function Wc(a,b){"string"==typeof b?(yb(a,!1),Wa(b,function(c,d,e,f){if(4==e)if(!f&&d){try{var g=JSON.parse(d);Wc(a,g.values)}catch(h){a.u("error (%s) parsing resource: %s\n",h.message,c)}yb(a,!0)}else a.u("error (%d) loading resource: %s\n",f,c)})):a.v.values=b}
function Xc(a,b){if(a.type>Q.NONE&&(a.ba?(a.K=new ArrayBuffer(a.size),a.W=new DataView(a.K,0,a.size),a.values=new Uint8Array(a.K,0,a.size),a.$=new Uint16Array(a.K,0,a.size>>1),new Int32Array(a.K,0,a.size>>2)):a.values=Array(a.size).fill(0),b))for(var c=0;c<b.length;c++)a.values[c]=b[c]}l=P.prototype;
l.qa=function(){if(this.v.values)a:{var a=this.j,b=this.ia,c=this.size,d=this.v.values,e=0,f=b&a.i;b>>>=a.h;c>d.length&&(c=d.length);for(;0<c&&b<a.g.length;){var g=a.g[b++];if(!g)break a;for(;0<c&&f<g.size;)g.Ga(f++,d[e++]),c--;f=0}}else this.type&Q.Sa&&this.values&&this.values.fill(0)};l.Pa=function(){return this.i};l.Oe=function(a){return this.l?this.Pa(a)|this.Pa(a+1)<<this.g:this.Pa(a+1)|this.Pa(a)<<this.g};l.Qb=function(a){return this.values?this.values[a]:0};l.Ra=function(a){return this.values[a]};
l.Hd=function(a){return this.values[a+1]|this.values[a]<<this.g};l.Id=function(a){return this.values[a]|this.values[a+1]<<this.g};l.We=function(a){return this.$[a>>>1]};l.Xe=function(a){return this.W.getUint16(a,this.l)};l.Me=function(a){return this.Ra(a+1)|this.Ra(a)<<this.g};l.Ne=function(a){return this.Ra(a)|this.Ra(a+1)<<this.g};l.Ia=function(){};l.lf=function(a,b){this.l?(this.Ia(a,b&this.i),this.Ia(a+1,b>>this.g)):(this.Ia(a,b>>this.g),this.Ia(a+1,b&this.i))};
l.hb=function(a,b){this.values&&(this.values[a]=b)};l.Ga=function(a,b){this.values[a]=b};l.uf=function(a,b){this.values[a]=b;this.Z=!0;this.m?this.O=this.Ga:this.za=this.Ga};l.Ab=function(a,b){this.values[a]=b>>this.g;this.values[a+1]=b&this.i};l.Bb=function(a,b){this.values[a]=b&this.i;this.values[a+1]=b>>this.g};l.Wb=function(a,b){this.$[a>>>1]=b};l.Xb=function(a,b){this.W.setUint16(a,b,this.l)};l.jf=function(a,b){this.Ga(a,b>>this.g);this.Ga(a+1,b&this.i)};
l.kf=function(a,b){this.Ga(a,b&this.i);this.Ga(a+1,b>>this.g)};l.vf=function(a,b){this.K?this.l==ra?(this.Wb(a,b),this.m?this.o=this.Wb:this.ga=this.Wb):(this.Xb(a,b),this.m?this.o=this.Xb:this.ga=this.Xb):this.l?(this.Bb(a,b),this.m?this.o=this.Bb:this.ga=this.Bb):(this.Ab(a,b),this.m?this.o=this.Ab:this.ga=this.Ab)};
l.sb=function(a){if(!this.M){var b=this;this.M++;this.s=a;this.T=this.Ba;this.U=this.ma;this.Ba=function(c){var d=b.T(c);b.s(b.ia,c,d);return d};this.ma=function(c){var d=b.U(c);b.s(b.ia,c,d);b.s(b.ia,c+1,d);return d};return!0}return this.s==a?(this.M++,!0):!1};l.Tb=function(a){if(!this.m){var b=this;this.m++;this.H=a;this.O=this.za;this.o=this.ga;this.za=function(c,d){b.H(b.ia,c,d);b.O(c,d)};this.ga=function(c,d){b.H(b.ia,c,d);b.H(b.ia,c+1,d);b.o(c,d)};return!0}return this.H==a?(this.m++,!0):!1};
l.tb=function(a){return this.M&&this.s==a?(--this.M||(this.Ba=this.T,this.ma=this.U,this.T=this.U=this.s=null),!0):!1};l.Vb=function(a){return this.m&&this.H==a?(--this.m||(this.za=this.O,this.ga=this.o,this.O=this.o=this.H=null),!0):!1};l.xa=function(a){var b=a.shift();if(this.S==b){this.Z=a.shift();a.shift();if(a=a.shift()){var c=this.size;c=void 0===c?0:c;if(a.length!=c){b=0;c=c?Array(c):[];for(var d=0;d<a.length-1;)for(var e=a[d++],f=a[d++];e--;)c[b++]=f;a=c}Xc(this,a)}return!0}return!1};
l.ya=function(a){a.push(this.S);a.push(this.Z);a.push(!1);if(this.values){var b=this.values;for(var c=0,d=0,e=[];c<b.length;){for(var f=b[c],g=c+1;g<b.length&&b[g]===f;)g++;e[d++]=g-c;e[d++]=f;c=g}b=e.length>=b.length?b:e}else b=this.values;a.push(b)};var Q={NONE:1,Gc:2,Sa:4,Xd:14,Rg:12};z.Memory=P;function Yc(a,b,c){P.call(this,a,b,c);this.J=[];this.N=[];this.h=[];this.R=[];void 0!=this.v.addr&&Rc(this.j,this.v.addr,this.v.size,Q.NONE,this)}v(Yc,P);
function Zc(a,b,c,d,e,f,g,h){for(var k;c<=d;c++){k=!1;if(e){if(a.J[c])break;a.J[c]=e.bind(b)}if(f){if(a.N[c])break;a.N[c]=f.bind(b)}if(g){if(a.h[c])break;a.h[c]=g.bind(b)}if(h){if(a.R[c])break;a.R[c]=h.bind(b)}k=!0}if(!k)throw Error(a.L("handler for port %#0x already exists",c));}function $c(a,b,c){var d=void 0===d?0:d;for(var e in c){var f=c[e];Zc(a,b,+e+d,+e+d,f[0],f[1],f[2],f[3])}}
Yc.prototype.Pa=function(a){var b,c=this.ia+a;if(b=this.J[c]){var d=b(c);var e=!0}else if(b=this.h[c])d=c&1?b(c&-2)>>this.g:b(c)&this.i,e=!0;else if(c&1)if(c&=-2,b=this.h[c])d=b(c)>>this.g,e=!0;else if(b=this.J[c])d=b(c),e=!0;e||(Vc(this.j,c,0),this.u(y.Db+y.Cb,"readNone(%#04x): unknown port\n",c),d=P.prototype.Pa.call(this,a));return d};
Yc.prototype.Ia=function(a,b){var c,d=this.ia+a;if(c=this.N[d]){c(d,b);var e=!0}else if(c=this.R[d])e=this.h[d]?this.h[d](d,!0):0,d&1?c(d,e&this.i|b<<this.g):c(d,e&~this.i|b),e=!0;else if(d&1)if(d&=-2,c=this.R[d])e=this.h[d]?this.h[d](d,!0):0,c(d,e&this.i|b<<this.g),e=!0;else if(c=this.N[d])c(d,b),e=!0;e||(Vc(this.j,d,1),this.u(y.Db+y.Cb,"writeNone(%#04x,%#04x): unknown port\n",d,b),P.prototype.Ia.call(this,a,b))};z.Ports=Yc;
function ad(a,b,c){c.type=Q.NONE;P.call(this,a,b,c);Rc(this.j,this.v.addr,this.v.size,Q.Sa);zb(this,this.qa.bind(this))}v(ad,P);z.RAM=ad;
function bd(a,b,c){c.type=Q.Gc;P.call(this,a,b,c);Rc(this.j,this.v.addr,this.v.size,this.v.type,this);zb(this,this.qa.bind(this));this.I=this.aa=void 0;if(z.LED&&this.ca[cd]){var d=this;this.J=Math.pow(2,Math.ceil(Math.log2(this.values.length)/2));this.N=this.values.length/this.J|0;this.h=new ac(a,b+"LEDs",{"class":"LED",bindings:{container:Ra(this,cd)},type:cc,cols:this.J,rows:this.N,color:H(this,"colorROM","green"),backgroundColor:H(this,"backgroundColorROM","black"),persistent:!0}),lc(this.h);
this.R=new Cb(a,b+"Input",{"class":"Input",location:[0,0,this.h.da,this.h.U,this.J,this.N],bindings:{surface:Ra(this,cd)}});this.da=Sa(this)||"";Fb(this.R,function(e,f){if(d.I){var g=d.da;0<=e&&0<=f&&(e=f*d.J+e,f=d.I,g=f.aa&&dd(f.aa,d.ia+e,1)||"");ib(d,Ta,g)}})}}v(bd,P);
bd.prototype.xa=function(a){var b=!0,c=a.shift();if(c&&this.h){var d=c.length;this.h.g.length==d?(this.h.g=c,kc(this.h,!0)):(this.u("inconsistent saved LED state (%d), unable to load\n",d),b=!1)}a.length&&(d=(a=a.shift())&&a.length||-1,this.values.length==d?this.values=a:(this.u("inconsistent saved ROM state (%d), unable to load\n",d),b=!1));return b};bd.prototype.pa=function(){void 0===this.I&&(this.I=O(this,"CPU"));void 0===this.aa&&(this.aa=O(this,"Debugger",!1))&&this.aa.Lb&&this.aa.Lb(this.v.symbols)};
bd.prototype.Ra=function(a){if(this.h){var b=this.h,c=nc;c=(void 0===c?0:c)&129;var d=4*((a/this.J|0)*b.M+a%this.J);if(d<=b.g.length-4){if(1!==b.g[d]||(b.g[d+3]&129)!==c)b.g[d]=1,b.g[d+3]=b.g[d+3]&-130|c|nc,b.O=!0;b.W=d;b.N=!0;b.J=0}}return this.values[a]};bd.prototype.ya=function(a){this.h&&(a.push(this.h.g),a.push(this.values))};var cd="array",Ta="cellDesc";z.ROM=bd;
function ed(a,b,c){c["class"]="CPU";L.call(this,a,b,c);this.aa=void 0;this.Gb=this.Rb=0;this.T=this.v.addrReset||0;this.time=O(this,"Time");this.time.K.push(this);this.time.Z.push(this);this.ka=this.$=0}v(ed,L);ed.prototype.abort=function(a){this.Gb=this.Rb;G(this,a.message);zc(this.time)};function fd(a,b){a.aa=b;return a.Ka}ed.prototype.ef=function(a){this.ka=this.$=void 0===a?0:a;return this.ka-this.$};ed.prototype.ff=function(){this.ka-=this.$;this.$=0};
function gd(a,b,c){c["class"]="Debugger";L.call(this,a,b,c);var d=this;this.fa=this.v.defaultRadix||16;this.ja=1;this.W=["(",")"];ya(this,"a",function(f,g,h,k,n){return C(d,n.V,d.fa,h)});ya(this,"n",function(f,g,h,k,n){return C(d,n,d.fa,h,0>g.indexOf("#")?"":void 0)});this.K=0;this.ka=y.NONE;this.M={};this.la=[];this.na=[];this.I=O(this,"CPU");this.Ka=fd(this.I,this);this.sa=O(this,"Input",!1);if(a=this.I.v.busMemory||this.v.busMemory){this.g=rb(this,a);if(a=this.I.v.busIO||this.v.busIO)this.j=rb(this,
a,!1);this.j||(this.j=this.g)}else this.g=this.j=O(this,"Bus");this.J=this.g.ea;this.Ca=Math.pow(2,this.J)-1|0;this.s=this.da=0;this.o=[];for(var e in S)this.o[S[e]]=[];this.m=[];this.m[S.Ea]=this.g;this.m[S.cb]=this.g;this.m[S.Ha]=this.j;this.m[S.Wa]=this.j;this.l=[];this.l[S.Ea]=this.re.bind(this);this.l[S.cb]=this.ue.bind(this);this.l[S.Ha]=this.pe.bind(this);this.l[S.Wa]=this.qe.bind(this);this.i=[];this.N=void 0;this.U=null;this.Z=0;this.time=O(this,"Time");this.time.Z.push(this);this.$=0;this.H=
[];this.T="";this.Kb(this,"state","dump machine state",this.Ce);this.ba=hd();this.ta=hd();this.ha=!1;this.R=0;this.h=[];Ma(this,this.He.bind(this));(e=vb(this,"commands"))&&bb(this,e)}v(gd,L);l=gd.prototype;l.Kb=function(a,b,c,d){this.H.push({Be:a,name:b,Ae:c,ob:d})};function id(a,b,c){for(var d,e=0;e<a.H.length;e++){var f=a.H[e];if(f.name==b){d=f.ob.call(f.Be,c);break}}return d}
l.Lb=function(a){if(a&&a.length)for(var b=0;b<a.length-2;b+=3){var c=jd(this,a[b]);if(c){var d=kd[a[b+1]];if(d){c={Oa:c,type:d,name:a[b+2]};d=this.la;var e=c,f=ld(d,e,this.Xc);0>f&&d.splice(-(f+1),0,e);d=this.na;e=ld(d,c,this.Yc);0>e&&d.splice(-(e+1),0,c)}}}};function ld(a,b,c){var d=0,e=a.length,f=0;for(void 0===c&&(c=function(k,n){return k>n?1:k<n?-1:0});d<e;){var g=d+e>>1,h=void 0;h=c(b,a[g]);0<h?d=g+1:(e=g,f=!h)}return f?d:~d}l.Xc=function(a,b){return a.name>b.name?1:a.name<b.name?-1:0};
l.Yc=function(a,b){return a.Oa.V>b.Oa.V?1:a.Oa.V<b.Oa.V?-1:0};function md(a,b,c){b=ld(a.na,{Oa:b,type:0,name:void 0},a.Yc);if(0<=b&&(a=a.na[b],!c||a.type==c))var d=a.name;return d}function nd(a,b,c,d){d=void 0===d?a.g:d;b.V=b.V+c&d.l}function hd(a){a=void 0===a?0:a;var b=od.Ud;return"number"==typeof a?{V:a,Sb:-1,type:b}:{V:a.V,Sb:a.Sb,type:a.type}}
function jd(a,b,c){if(b){var d=hd();var e=0,f=b.charAt(e);switch(f){case "&":e++;break;case "#":e++;d.type=od.Vd;break;case "%":e++,f=b.charAt(e),"%"==f?e++:d.type=od.Mc}f=b.indexOf(":",e);if(0<=f){var g=pd(a,b.substring(e,f),c);void 0==g?d=null:(d.Sb=g,e=f+1)}d&&(b=pd(a,b.substring(e),c),void 0==b?d=null:d.V=b&a.Ca)}return d}function qd(a,b,c,d){d=void 0===d?a.g:d;a.s++;var e=d.Qb(b.V);c&&nd(a,b,c,d);a.s--;return e}
function rd(a,b,c){if(32>=a.J)return b&c;b=T(a,b,0,!0);c=T(a,c,0,!0);return((b/F|0)&(c/F|0))*F+((b&c)>>>0)}function sd(a,b,c){if(32>=a.J)return b^c;b=T(a,b,0,!0);c=T(a,c,0,!0);return((b/F|0)^(c/F|0))*F+((b^c)>>>0)}
function td(a,b,c,d){for(d=void 0===d?-1:d;d--&&c.length;){var e=c.pop();if(2>b.length)return!1;var f=b.pop();var g=b.pop();switch(e){case "*":g*=f;break;case "/":if(!f)return!1;g=Math.trunc(g/f);break;case "^/":if(!f)return!1;g%=f;break;case "+":g+=f;break;case "-":g-=f;break;case "<<":g<<=f;break;case ">>":g>>=f;break;case ">>>":g>>>=f;break;case "<":g=g<f?1:0;break;case "<=":g=g<=f?1:0;break;case ">":g=g>f?1:0;break;case ">=":g=g>=f?1:0;break;case "==":g=g==f?1:0;break;case "!=":g=g!=f?1:0;break;
case "&":g=rd(a,g,f);break;case "!":case "|":e=g;32>=a.J?g=e|f:(e=T(a,e,0,!0),f=T(a,f,0,!0),g=(e/F|0|f/F|0)*F+((e|f)>>>0));break;case "^!":g=sd(a,g,f);break;case "&&":g=g&&f?1:0;break;case "||":g=g||f?1:0;break;case ",,":g=T(a,g,18,!0)*Math.pow(2,18)+T(a,f,18,!0);break;case "_":case "^_":"^_"==e&&(f=35-(f&255));f&&(g=T(a,g,0,!0),g=0<f?g*Math.pow(2,f):Math.trunc(g/Math.pow(2,-f)));break;default:return!1}b.push(T(a,g))}return!0}
function ud(a,b,c,d,e,f){var g,h=!1,k=0,n=[],p=[],q=a.fa;for(a.fa=e;c<d;){var r=b[c++].trim();var w=c<d?b[c++]:"";if(r){var x=void 0;var u=a;var A=r,t=f;k=void 0===k?0:k;if(void 0!=A){x=wb(u,A.toUpperCase());if(void 0==x){x=void 0;var Ea=u,X=ld(Ea.la,{Oa:null,type:0,name:A},Ea.Xc);0<=X&&(x=Ea.la[X].Oa.V);if(void 0==x)if(x=A,u.M[x]?x=u.M[x].value:(x=x.substr(0,6),x=u.M[x]&&u.M[x].value),void 0==x)x=va(A,1<A.length||10<u.fa?u.fa:10);else if(A=u.M[A]&&u.M[A].eh)t?t.push(A):(t=pd(u,A,t),void 0!==t?x+=
t:x=void 0)}void 0!=x&&(x=T(u,vd(u,x,k)))}u=x}else if("{"==w){r=1;for(u=c;c<d;)if(c++,w=c<b.length?b[c++]:"","{"==w)r++;else if("}"==w&&!--r)break;u=ud(a,b,u,c-1,a.fa,f);null!=u&&k&&(u=vd(a,u,k));r=c<d?b[c++].trim():"";w=c<d?b[c++]:""}else{if(" "==w)continue;if("^B"==w){a.fa=2;continue}if("^O"==w){a.fa=8;continue}if("^D"==w){a.fa=10;continue}if(!(k&-1073741824)){if("+"==w)continue;if("-"==w){k=k<<2|1;continue}if("~"==w||"^-"==w){k=k<<2|2;continue}if("^L"==w){k=k<<2|3;continue}}h=!0;break}if(void 0===
u)if(f)f.push(r),u=0;else{h=!0;break}n.push(T(a,u));if(" "==w)if(c<b.length-1&&!b[c])c++,w=b[c++];else{h=!0;break}if(!w)break;u="<"==a.W[0]?wd:xd;if(!u[w]){h=!0;break}p.length&&u[w]<=u[p[p.length-1]]&&td(a,n,p,1);p.push(w);a.fa="^_"==w?10:e;k=0}if(h||!td(a,n,p)||1!=n.length)h=!0;h?f||a.u("parse error (%s)\n",r||w):g=n.pop();a.fa=q;return g}
function yd(a,b,c,d){for(var e,f=a.J/d|0;0<=(e=b.indexOf(c));){for(var g=0,h=e+1,k=f;h<b.length;){var n=b[h++];if(n==c){k=-1;break}if(!k)break;k--;n=n.charCodeAt(0);6==d&&(n-=32);n&=(1<<d)-1;g=T(a,g*Math.pow(2,d)+n,d*f,!0)}if(0<=k){a.u("parse error (%c%s%c)\n",c,b,c);return}b=b.substr(0,e)+C(a,g)+b.substr(h)}return b}
function pd(a,b,c){if(b){"{"!=a.W[0]&&(b=b.split(a.W[0]).join("{").split(a.W[1]).join("}"));b=yd(a,b,'"',8);if(!b)return d;b=yd(a,b,"'",6);if(!b)return d;16!=a.fa&&(b=b.replace(/(^|[^A-Z0-9$%.])([0-9]+)B/,"$1$2^_").replace(/\s+/g," "));b=b.split(/({|}|\|\||&&|\||\^!|\^B|\^O|\^D|\^L|\^-|~|\^_|_|&|!=|!|==|>=|>>>|>>|>|<=|<<|<|-|\+|\^\/|\/|\*|,,| )/);var d=ud(a,b,0,b.length,a.fa,c)}return d}
function vd(a,b,c){for(;c;){var d;switch(c&3){case 1:b=-T(a,b);break;case 2:b=sd(a,b,-1);break;case 3:for(d=35;0<=d&&!rd(a,b,Math.pow(2,d));)d--;b=35-d}c>>>=2}return b}function T(a,b,c,d){var e=b;c=c||a.J;if(d)if(32==c)e=b>>>0;else if(32>c)e=b&(1<<c)-1;else{if(a=Math.pow(2,c),0>b||b>=a)e=b%a,0>e&&(e+=a)}else 32>=c?e=b<<32-c>>32-c:(a=Math.pow(2,c-1),b>=a?(e=b%a,(b/a|0)&1&&(e-=a)):b<-a&&(e=b%a,((-b-1)/a|0)&1?e&&(e+=a):e||(e-=a)));b!=e&&(b=e);return b}
l.Mb=function(a){function b(h){for(var k=0;k<h.length;k++)if(void 0!=h[k])return!1;return!0}if(-1>a)return zd(this,this.Mb);var c="";if(0<=a){var d=this.i[a];if(void 0!=d){c=d>>8;d&=255;var e=this.m[c];if(e){var f=this.o[c],g=f[d];(c&1?e.Vb(g.V,this.l[c]):e.tb(g.V,this.l[c]))?(f[d]=void 0,this.i[a]=void 0,b(f)&&(f.length=0,b(this.i)&&(this.i.length=0)),c=this.L("%2d: %s %*a cleared\n",a,Ad[c],e.ea,g),--this.da||this.ha||(c+=Bd(this,!1))):c=this.L("invalid break address: %*a\n",e.ea,g)}else c="invalid bus"}else c=
this.L("invalid break index: %d\n",a)}else c="missing break index\n";return c};function Cd(a,b){if(a.U&&(void 0==b||a.U.V==b)){var c=void 0===c?S.Ea:c;b=-1;var d=Dd(a.U,a.o[c]);if(0<=d)for(var e=0;e<a.i.length;e++){var f=a.i[e];if(void 0!=f&&c==f>>8&&d==(f&255)){b=e;break}}c=b;0<=c&&a.Mb(c);a.U=null}}
l.Nb=function(a,b){b=void 0===b?!1:b;if(-1>a)return zd(this,this.Nb,b);if(0<=a){var c=this.i[a];if(void 0!=c){var d=c>>8;c=this.o[d][c&255];if(void 0!=c){var e=b?"enabled":"disabled",f=this.m[d];!c.disabled==!b?(c.disabled=!b,a=this.L("%2d: %s %*a %s\n",a,Ad[d],f.ea,c,e)):a=this.L("%2d: %s %*a already %s\n",a,Ad[d],f.ea,c,e)}else a=this.L("no break address at index: %d\n",a)}else a=this.L("invalid break index: %d\n",a)}else a="missing break index\n";return a};
function zd(a,b,c){for(var d="",e=0;e<a.i.length;e++)void 0!=a.i[e]&&(d+=b.call(a,e,c));d||(d="no break addresses found");return d}function Ed(a,b,c){c=void 0===c?S.Ea:c;a=a.o[c];for(c=0;c<a.length;c++){var d=a[c];if(d.V==b)return d}}function Dd(a,b){for(var c=0;c<b.length;c++)if(b[c].V==a.V)return c;return-1}
function Fd(a,b){b=void 0===b?!1:b;for(var c="",d=0;d<a.i.length;d++){var e=a.i[d];if(void 0!=e){var f=e>>8;e=a.o[f][e&255];f=a.L("%s %*a",Ad[f],a.m[f].ea,e);b?(c&&(c+=";"),c+=f,e.disabled&&(c+=";bd "+d)):c+=a.L("%2d: %s %s\n",d,f,e.disabled?"disabled":"enabled")}}c||b||(c="no break addresses found\n");return c}
function Gd(a,b,c){c=void 0===c?S.Ea:c;if(b){var d=a.m[c];if(d){var e=a.o[c];var f=Dd(b,e);if(0<=f)f=-(f+1);else{for(f=0;f<e.length&&void 0!=e[f];f++);e[f]=b}e=f;if(0<=e)if(f=c&1?d.Tb(b.V,a.l[c]):d.sb(b.V,a.l[c])){for(f=0;f<a.i.length&&void 0!=a.i[f];f++);a.i[f]=c<<8|e;b=a.L("%2d: %s %*a set\n",f,Ad[c],d.ea,b);a.da++||a.h.length||(b+=Bd(a,!0))}else b=a.L("invalid break address: %*a\n",d.ea,b),a.o[c][e]=void 0;else b=a.L("%s %*a already set\n",Ad[c],d.ea,b)}else b="invalid bus"}else b="missing break address\n";
return b}function Hd(a,b){0<=b&&(a.K=b);var c="instruction break count: "+(0<a.K?a.K:"disabled")+"\n";0<b&&(a.h.length||(c+=Bd(a,!0)),a.ha=!0);return c}function Id(a,b){var c;if(b){var d=cb(b);void 0!=d?a.ka=d?y.$b:y.NONE:c=a.L("unrecognized message option: %s\n",b)}c||(c=a.L("break on message: %b\n",!!a.ka));return c}l.pe=function(a,b){this.s||(void 0==a?Jd(this,"break on unknown input %#0x: %#0x",b):(a=Ed(this,a+b,S.Ha))&&!a.disabled&&Jd(this,"break on input %*a: %#0x",this.j.ea))};
l.qe=function(a,b){this.s||(void 0==a?Jd(this,"break on unknown output %#0x: %#0x",b):(a=Ed(this,a+b,S.Wa))&&!a.disabled&&Jd(this,"break on output %*a: %#0x",this.j.ea))};
l.re=function(a,b){this.s||(void 0==a?Jd(this,"break on unknown read %#0x: %#0x",b):(a+=b,this.h.length&&a==this.I.Rb&&(this.Z++,0<this.K&&(--this.K||Jd(this,"break on instruction count")),this.h[this.R++]=a,this.R==this.h.length&&(this.R=0)),(b=Ed(this,a,S.Ea))&&!b.disabled&&(Jd(this,"break on read %*a: %#0x",this.g.ea),Cd(this,a))))};l.ue=function(a,b){this.s||(void 0==a?Jd(this,"break on unknown write %#0x: %#0x",b):(a=Ed(this,a+b,S.cb))&&!a.disabled&&Jd(this,"break on write %*a: %#0x",this.g.ea))};
function Jd(a,b,c){b=a.L.apply(a,[b].concat(ba(c)));G(a,b);zc(a.time)}function Kd(a,b,c){c=void 0===c?a.g:c;return C(a,b.V,a.fa,c.ea,"")}function Ld(a,b,c){c=void 0===c?10:c;var d="";if(a.h.length){var e,f=[];c>a.h.length&&(c=a.h.length);0>b&&(b=c);var g=a.R-b;for(0>g&&(g+=a.h.length);0<=g&&g<a.h.length&&0<c;){var h=a.h[g++];if(void 0==h)break;g==a.h.length&&(g=0);e?e.V=h:e=hd(h);for(h=0;h<a.ja;h++)f[h]=qd(a,e,1);nd(a,e,-f.length);d+=a.Ub(e,f,a.L("[%6d]",b--));c--}}return d||"no history"}
function dd(a,b,c){var d=[],e="";for(b="number"==typeof b?hd(b):b;c--;){for(nd(a,b,d.length);d.length<a.ja;)d.push(qd(a,b,1));nd(a,b,-d.length);e+=a.Ub(b,d)}return e}
function Md(a,b,c,d,e,f){var g="";f=f?a.j:a.g;c||(c=f.j);var h=c>>3;d||(d=128);var k=0,n=d+15>>4||1,p=4==h?16:a.fa;"y"==e&&(p=h,n=d,k=8*h);b||(b=a.ta);for(;n--&&0<d;){var q=e=0,r,w="",x="",u=Kd(a,b,f);for(r=p;0<r&&0<d;r--){var A=qd(a,b,1,f);e|=A<<(q++<<3);q==h&&(w+=C(a,e,0,c,""),w+=1==h?9==r?"-":" ":" ",k&&(x+=C(a,e,2,c,"")),e=q=0);k||(x+=32<=A&&127>A?String.fromCharCode(A):".");d--}g&&(g+="\n");g+=u+"  "+w+" "+x}a.ta=b;return g}
l.Ce=function(){var a=[];ub(this,function(b){b.gb&&b.gb(a);return!0});return JSON.stringify(a,null,2)};function Nd(a,b,c,d){var e=0,f="";d=d?a.j:a.g;for(var g=0;void 0!=b&&g<c.length;g++){var h=qd(a,b,0,d);if(void 0==h)break;var k=a,n=b,p=c[g],q=d;q=void 0===q?k.g:q;k.s++;q.hb(n.V,p);k.s--;f+=a.L("%*a: %#*n changed to %#*n\n",a.g.ea,b,a.g.j,h,a.g.j,c[g]);nd(a,b,1,d);e++}e||(f+=a.L("%d locations updated\n",e));a.time.update();return f}
function Bd(a,b){var c="";void 0!=b&&b==!a.h.length&&Tc(a.g,function(d){b?a.g.sb(d.ia,a.l[S.Ea]):a.g.tb(d.ia,a.l[S.Ea])})&&(b?(a.R=0,a.h=Array(Od)):a.h=[]);return c+=a.L("instruction history %s\n",a.h.length?"enabled":"disabled")}l.xa=function(a){var b=a.shift();return this.S==b?(bb(this,a.shift()),this.X.oa=a.shift(),!0):!1};l.bd=function(a){wa(this.ka,a)?Jd(this,"break on message"):this.time.R=!0};
l.He=function(a){var b=a[1],c=a[2],d=[],e=[],f=!1,g="";this.N=void 0;if("*"==c)var h=-2;else{h=va(c);void 0==h&&(h=-1);var k=jd(this,c,e);if(null===k)return}var n=0;a[3]&&(n=va(a[3].substr("l"==a[3][0]?1:0))||8);for(var p=3;p<a.length;p++)d.push(va(a[p],16));if("d"==b){p=id(this,c,d);if(void 0!=p)return p;b=this.T||b}if("s"!=b[0]&&e.length)return"unrecognized symbol(s): "+e;switch(b[0]){case "b":"c"==b[1]?g=this.Mb(h):"d"==b[1]?g=this.Nb(h):"e"==b[1]?g=this.Nb(h,!0):"i"==b[1]?g=Gd(this,k,S.Ha):"l"==
b[1]?g=Fd(this):"m"==b[1]?g=Id(this,c):"n"==b[1]?g=Hd(this,h):"o"==b[1]?g=Gd(this,k,S.Wa):"r"==b[1]?g=Gd(this,k,S.Ea):"w"==b[1]?g=Gd(this,k,S.cb):"?"==b[1]?(g="break commands:\n",Pd.forEach(function(q){g+=q+"\n"})):b[1]&&(g=void 0);break;case "d":this.T=b;if("b"!=b[1]&&b[1])if("w"==b[1])c=16;else if("d"==b[1])c=32;else if("i"==b[1]){if(!this.j){g="invalid bus";break}c=this.j.j;n=n||1;f=!0}else{if("h"==b[1])this.T="",g=Ld(this,h,n);else if("?"==b[1]){if(this.T="",g="dump commands:\n",Qd.forEach(function(q){g+=
q+"\n"}),this.H.length)for(g+="dump extensions:\n",b=0;b<this.H.length;b++)k=this.H[b],g+=this.L("d   %-12s%s\n",k.name,k.Ae)}else this.T="",g=void 0;break}else c=8;g=Md(this,k,c,n,b[2],f);break;case "e":if("o"==b[1]){if(!this.j){g="invalid bus";break}f=!0}else if(b[1]){g=void 0;break}g=Nd(this,k,d,f);break;case "g":if(this.time.start()){if(void 0!=k){Cd(this);g=Gd(this,k);if(2!=g.indexOf(":"))break;this.U=k;g=""}break}g="already started\n";break;case "h":zc(this.time)||(g="already stopped\n");break;
case "p":a.shift();a.shift();b=a.join(" ");g+=this.L("%s = %s\n",b,C(this,pd(this,b)));break;case "r":if(b=b.substr(1).toUpperCase()){if(void 0==wb(this.I,b)){g+=this.L("unrecognized register: %s\n",b);break}void 0!=k&&Bb(this.I,b,k.V)}this.ba.V=this.I.Gb;g+=this.I.toString();break;case "s":k=cb(c);if("h"==b[1]){if(this.da||0<this.K)k=void 0;g=Bd(this,k);void 0!=k&&(this.ha=k)}else"p"==b[1]?0<h?(wc(this.time,h),g="target speed:  "+Cc(this.time.o)):g="current speed: "+Kc(this.time):"s"==b[1]&&this.wa?
(h=this.wa.indexOf(c),0<=h&&(this.style=this.wa[h]),g="style: "+this.style):"?"==b[1]?(g="set commands:\n",Rd.forEach(function(q){g+=q+"\n"})):g=void 0;break;case "t":n=va(c,10)||1;this.N=!0;if(b[1]){if("r"!=b[1]){g=void 0;break}this.N=!1}Ec(this.time,n);break;case "u":if(b[1]){g=void 0;break}n||(n=8);k||(k=this.ba);g+=dd(this,k,n);this.ba=k;break;case "?":g="debugger commands:\n";Sd.forEach(function(q){g+=q+"\n"});break;default:g=void 0}void 0==g&&a[0]&&(g="unrecognized command '"+a[0]+"' (try '?')\n");
return g};l.Ob=function(a){return a&&this.xa(a[0])?(a.shift(),!0):!1};l.gb=function(a){var b=[];this.ya(b);a.push(b);this.$=0};l.cd=function(a){if(a){if(this.time.g){if(this.$&&this.sa){a=this.sa;var b=a.i;b&&xb(a.X)&&(a.u(y.Ha,'setFocus("%s")\n',b.id||b.nodeName),b.focus(),b.scrollIntoView())}}else this.N?this.Ma(dd(this,this.I.Gb,1)):(this.Z&&(G(this.I,this.Z+" instructions executed"),this.Z=0),this.I.Ma(this.I.toString()),void 0==this.N&&this.$&&(a=this.Ta(Ja.kb,!0))&&a.focus());this.$++}};
l.ya=function(a){a.push(this.S);a.push(Fd(this,!0));a.push(this.X.oa)};l.Ub=function(a,b,c){var d=this.L,e=Kd(this,a);b=b.shift();nd(this,a,1);return d.call(this,"%s %02x       unsupported       ; %s\n",e,b,c||"")};
var Sd="b?\t\tbreak commands;d?\t\tdump commands;e[o] [addr] ...\tedit memory/ports;g    [addr]\trun (to addr);h\t\thalt;p    [expr]\tparse expression;r?   [value]\tdisplay/set registers;s?\t\tset commands;t[r] [n]\tstep (n instructions);u    [addr] [n]\tunassemble (at addr)".split(";"),Pd="bc [n|*]\tclear break address;bd [n|*]\tdisable break address;be [n|*]\tenable break address;bl [n]\t\tlist break addresses;bi [addr]\tbreak on input;bo [addr]\tbreak on output;br [addr]\tbreak on read;bw [addr]\tbreak on write;bm [on|off]\tbreak on message;bn [count]\tbreak on instruction count".split(";"),
Qd="db  [addr]\tdump bytes (8 bits);dw  [addr]\tdump words (16 bits);dd  [addr]\tdump dwords (32 bits);di  [addr]\tdump input ports;d*y [addr]\tdump values in binary;dh  [n] [l]\tdump instruction history buffer;ds\t\tdump machine state".split(";"),Rd=["sh [on|off]\tset instruction history","sp [n]\t\tset speed multiplier","ss\t\tset debugger style"],od={Mc:1,Ud:0,Vd:2,Og:0},S={Ea:0,cb:1,Ha:2,Wa:3},Td={},Ad=(Td[S.Ea]="br",Td[S.cb]="bw",Td[S.Ha]="bi",Td[S.Wa]="bo",Td),Ud={Td:"PC"},Vd={BYTE:1,Sd:2,Wd:4,
zc:5,hc:6,le:7},kd={"=":Vd.le,1:Vd.BYTE,2:Vd.Sd,4:Vd.Wd,"@":Vd.zc,";":Vd.hc},Od=1E5,xd={"||":5,"&&":6,"!":7,"|":7,"^!":8,"&":9,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,_:19,"^_":19,"{":20,"}":20},wd={",,":1,"||":5,"&&":6,"!=":10,"==":10,">=":11,">":11,"<=":11,"<":11,">>>":12,">>":12,"<<":12,"-":13,"+":13,"^/":14,"/":14,"*":14,"!":15,"|":15,"^!":15,"&":15,_:19,"^_":19,"{":20,"}":20};function Wd(a,b,c){ed.call(this,a,b,c)}v(Wd,ed);
function Xd(a,b,c){ed.call(this,a,b,c);this.model=+this.v.model||Yd;this.T=+this.v.addrReset||0;this.o=O(this,"Bus");this.o.H=this.Jd.bind(this);this.Fe=O(this,"IOPage");O(this,"Panel",!1);this.K=0;this.$a=null;O(this,"Input",!1);this.model<=Zd?(this.Qc=this.se,this.Yb=~($d|ae|be|ce)&65535,this.Tc=0):(this.Qc=this.te,this.Yb=~($d|(this.model<=de?ae:0))&65535,this.Tc=this.model>de?ae:0);this.Ib=this.Hb=this.la=0;this.l=null;this.Ya=[];ee(this)}v(Xd,Wd);
function ee(a){a.ba=65536;a.ha=32768;a.ja=65535;a.da=32768;a.W=15;a.h=[0,0,0,0,0,0,0,a.T,-1,-2,-3,-4,-5,-6,-7,-8];a.Z=[0,0,0,0,0,0];a.va=[0,0,0,0];a.wa=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];a.Ca=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535,65535],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];a.Qa=
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];a.Vc=[0,0,0,0,0,0,0,0];a.i=0;a.s=-1;a.Uc=0;a.g=0;fe(a);for(var b={La:0};7>=b.La;b={La:b.La},b.La++)M(a,"R"+b.La,function(c){return function(){return a.h[c.La]}}(b),function(c){return function(d){return a.h[c.La]=d&65535}}(b));tb(a,"R6","SP");tb(a,"R7",Ud.Td);M(a,"CF",function(){return a.ba&65536&&ge?1:0},function(c){a.ba=c?65536:0});M(a,"NF",function(){return a.da&32768&&he?1:0},function(c){a.da=c?32768:0});M(a,"VF",function(){return a.ha&
32768&&ie?1:0},function(c){a.ha=c?32768:0});M(a,"ZF",function(){return(a.ja&65535?0:le)?1:0},function(c){a.ja=c?0:1});M(a,"PS",function(){return me(a)},function(c){return ne(a,c)});M(a,"PI",function(){return a.ta},function(c){if(c&=oe){var d=c>>pe;do c+=qe;while(d>>=1);a.g|=re}a.ta=c});M(a,"ER",function(){return a.ra});M(a,"SL",function(){return a.M&65280},function(c){a.M=c|255});M(a,"M0",function(){return se(a)},function(c){return te(a,c)});M(a,"M1",function(){return ue(a)});M(a,"M2",function(){return ve(a)});
M(a,"M3",function(){return a.H},function(c){return we(a,c)})}function fe(a){a.j=0;a.na=0;a.sa=0;a.H=0;a.ra=0;a.ta=0;a.M=255;a.U=0;a.N=0;a.R=0;a.J=262143;a.Sc=[4,2,0,1];a.O=a.h[7];a.m=0;a.l=null;xe(a);for(var b=a.o,c=Q.Sa,d=0,e=0;e<b.g.length;e++){var f=b.g[e];f.type&c&&(d=f.ia+f.size)}a.Ee=d}l=Xd.prototype;l.cd=function(){};function se(a){var b=a.j;b&ye||(b=b&~(ze|Ae|Be)|a.N<<5|a.R<<1);return b}
function te(a,b){b&=~ze;if(a.j!=b){b&ye&&!(a.j&ye)&&(a.na=a.m>>16&65535,a.sa=a.m&65535);a.j=b;a.N=(b&Be)>>Ce;a.R=(b&Ae)>>De;var c=0;b&(Ee|Fe)&&(c=Ge,b&Ee&&(c|=He));a.U!=c&&(a.U=c,xe(a))}}function ue(a){a.j&ye||(a.na=a.m>>16&65535);a=a.na;a&65280&&(a=(a<<8|a>>8)&65535);return a}function ve(a){a.j&ye||(a.sa=a.m&65535);return a.sa}function we(a,b){a.model<Yd&&(b&=~(Ie|Je));a.H!=b&&(a.H=b,a.J=b&Ie?Ke:Le,xe(a))}
function xe(a){a.$a&&Uc(a.o,a.K,a.$a);a.U?(a.Za=Me,a.K=a.H&Ie?Ne:Oe,a.Fb=a.Ze,a.Wc=a.xf):(a.Za=0,a.K=Pe,a.Fb=a.Ye,a.Wc=a.wf);a.$a=Uc(a.o,a.K,a.Fe)}
l.xa=function(a){if(!a||!a.length)return G(this,"invalid saved state"),!1;var b=a.shift(),c=a.shift();if(b!=this.S||3!==(c|0))return this.u("CPU state mismatch (%s %3.2f)\n",b,c),!1;try{this.h=a.shift();this.Z=a.shift();this.va=a.shift();this.wa=a.shift();this.Ca=a.shift();this.Qa=a.shift();this.Vc=a.shift();this.ra=a.shift();this.Uc=a.shift();this.ta=a.shift();this.M=a.shift();this.N=a.shift();this.R=a.shift();this.O=a.shift();this.g=a.shift();this.m=a.shift();this.s=a.shift();this.Hb=a.shift();
this.Ib=a.shift();this.T=a.shift();ne(this,a.shift());te(this,a.shift());this.na=a.shift();this.sa=a.shift();we(this,a.shift());for(var d=a.shift(),e=d.length-1;0<=e;e--){a:{for(a=0;a<this.Ya.length;a++){var f=this.Ya[a];if(f.vb===d[e]){var g=f;break a}}g=null}g&&(g.next=this.l,this.l=g)}}catch(h){return G(this,"CPU state error: "+h.message),!1}return!0};
l.ya=function(a){a.push(this.S);a.push(3);a.push(this.h);a.push(this.Z);a.push(this.va);a.push(this.wa);a.push(this.Ca);a.push(this.Qa);a.push(this.Vc);a.push(this.ra);a.push(this.Uc);a.push(this.ta);a.push(this.M);a.push(this.N);a.push(this.R);a.push(this.O);a.push(this.g);a.push(this.m);a.push(this.s);a.push(this.Hb);a.push(this.Ib);a.push(this.T);a.push(me(this));a.push(se(this));a.push(ue(this));a.push(ve(this));a.push(this.H);for(var b=a.push,c=[],d=this.l;d;)c.push(d.vb),d=d.next;b.call(a,c)};
function Qe(a,b,c){b={vb:b,priority:4,message:c||0,name:Re[b],next:null};a.Ya.push(b);return b}function Se(a,b){if(b){if(b!=a.l){var c=a.l;if(!c||c.priority<=b.priority)b.next=c,a.l=b;else{do{var d=c.next;if(!d||d.priority<=b.priority){b.next=d;c.next=b;break}c=d}while(c)}}a.g|=re;a.u(y.INT+b.message,"setIRQ(vector=%o,priority=%d)\n",b.vb,b.priority+")")}}function me(a){return a.W=a.W&(ce|be|ae|Te|Ue)|(a.da&32768?he:0)|(a.ja&65535?0:le)|(a.ha&32768?ie:0)|(a.ba&65536?ge:0)}
function ne(a,b){b&=a.Yb;a.da=b<<12;a.ja=~b&4;a.ha=b<<14;a.ba=b<<16;if((b^a.W)&a.Tc)for(var c=a.Z.length;0<=--c;){var d=a.h[c];a.h[c]=a.Z[c];a.Z[c]=d}a.i=b>>Ve&We;c=a.W>>Ve&We;a.i!=c&&(a.va[c]=a.h[6],a.h[6]=a.va[a.i]);a.W=b;a.g&=~Xe;a.g|=a.l?Xe:re}l.Jd=function(a,b){3>=b&&(this.I.ra|=Ye);Ze(this,$e,0,a)};
function Ze(a,b,c,d){a.u(y.Jc,"trap to vector %o (%o: %s)\n",b,d,0>d?af[-d]:"BUS ERROR");if(!a.la){0>a.s?a.s=me(a):a.i||(d=bf);d==bf&&(a.g&cf&&(d=df),a.g|=cf,a.ra|=ef,a.h[6]=b=4);if(d!=df){a.m=b|4143316992;a.i=0;var e=a.Fb(b|a.Za),f=a.Fb(b+2&65535|a.Za);ne(a,f&~be|a.s>>2&be);ff(a,a.s);ff(a,a.h[7]);a.h[gf]=e&65535}a.g&=~(c|hf|jf);a.g=a.g|re|kf;a.s=-1;a.Hb=d;a.Ib=b;d==df&&zc(a.time);if(d>=bf)throw b;}}function lf(a,b){var c=b>>13&31;31>c&&(b=a.H&Je?a.Qa[c]+(b&8191)&Ke:b&~mf);return b}
function nf(a,b,c){if(!(c&a.U)){var d=b&65535;d>=Pe&&(d|=a.K);return d}var e=b>>13;a.H&a.Sc[a.i]||(e&=7);var f=a.Ca[a.i][e];d=(a.wa[a.i][e]<<6)+(b&8191)&a.J;d>=mf&&(d=lf(a,d));if(a.la)return d;d>=a.Ee&&d<a.K?(a.ra|=of,Ze(a,$e,0,d)):d&1&&!(c&pf)&&(a.ra|=qf,Ze(a,$e,0,d));var g=0;switch(f&rf){case sf:g=tf;case uf:f|=vf;c&Ge&&(g=wf);break;case xf:g=tf;case yf:c&Ge&&(g=tf);case zf:f|=c&Ge?vf|Af:vf;break;default:g=Bf}(f&(Cf|Df))!=Cf&&(f&Df?f&Cf&&(b&8128)<(f>>2&8128)&&(g|=Ef):(b&8128)>(f>>2&8128)&&(g|=Ef));
a.Ca[a.i][e]=f;if(d!=((Ne|Ff)&a.J)||a.i)a.N=a.i,a.R=e;g&&(g&ye&&(0<=a.s&&(g|=Gf),a.j&ye||(g|=a.j&tf|a.N<<5|a.R<<1,te(a,a.j&~Hf|g&Hf)),Ze(a,If,Jf,Kf)),a.j&(ye|tf)||!(d<((Ne|Lf)&a.J)||d>((Ne|Mf|1)&a.J))||(a.j|=tf,a.j&Nf&&(a.g|=Jf)));return d}function ff(a,b){var c=a.h[6]-2&65535;a.h[6]=c;a.m=a.m&65535|(a.m&-65536)<<8|16121856;a.g&cf||a.Qc(Of,-2,c);a.Wc(c,b)}l.se=function(a,b,c){!this.i&&0>=b&&c<=this.M&&(this.g|=Pf)};
l.te=function(a,b,c){this.i||(65534<=c&&(c|=-65536),a&Ge&&c<=this.M&&(c<=this.M-32?Ze(this,$e,0,bf):(this.ra|=Qf,this.g|=Pf)))};l.Ye=function(a){return this.o.ma(this.O=a)};l.Ze=function(a){return this.o.ma(this.O=nf(this,a,Rf))};l.wf=function(a,b){this.o.ga(this.O=a,b)};l.xf=function(a,b){this.o.ga(this.O=nf(this,a,Of),b)};
l.toString=function(){var a="";if(this.aa)for(var b="R0 R1 R2 R3 R4 R5  SP PC PS PI SL NF ZF VF CF  M0 M1 M2 M3 ER  SR AR DR".split(" "),c=0;c<b.length;c++){var d=b[c];if(d){var e=16;"F"==d[1]&&(e=1);var f=wb(this,d);void 0!=f&&(a+=this.aa.L("%s=%*n ",d,e,f))}else a+="\n"}return a};
var Zd=1120,de=1140,Yd=1170,We=3,ge=1,ie=2,le=4,he=8,Ue=16,Te=224,$d=1792,ae=2048,be=12288,ce=49152,Ve=14,oe=65024,qe=34,pe=9,$e=4,If=168,df=-1,Kf=-2,bf=-4,af="UNKNOWN PANIC ABORT ILLEGAL RED YELLOW FAULT TRACE HALT OPCODE INTERRUPT".split(" "),re=1,Xe=2,jf=3,hf=16,Pf=32,Jf=64,kf=128,cf=256,gf=7,pf=1,He=2,Ge=4,Me=65536,ef=4,Qf=8,Ye=16,of=32,qf=64,Ee=1,Ae=30,Be=96,Gf=128,Fe=256,Nf=512,ze=3072,tf=4096,wf=8192,Ef=16384,Bf=32768,ye=57344,Hf=61694,De=1,Ce=5,Ie=16,Je=32,sf=1,uf=2,xf=4,yf=5,zf=6,rf=7,Df=
8,Af=64,vf=128,Cf=32512,Lf=62592,Ff=65402,Mf=65470,Re={48:"DL11R",52:"DL11X",56:"PC11R",60:"PC11X",64:"KW11",112:"RL11",144:"RK11",180:"RX11"},Rf=0|He,Of=0|Ge,Pe=57344,Oe=253952,Ne=4186112,Le=262143,mf=3932160,Ke=4194303;z.PDP11=Xd;function Sf(a,b,c){gd.call(this,a,b,c);this.va=Tf;this.O=[];this.I.model<de&&(this.O=this.O.concat(Uf));1145>this.I.model&&(this.O=this.O.concat(Vf));this.ja=6}v(Sf,gd);
Sf.prototype.Ub=function(a,b,c){function d(D){var B=k.I,E=[];if(B.U){var R=B.i<<1,N=D>>13;7<N&&(R|=1);B.H&B.Sc[B.i]||(N&=7);var je=D&8191,ke=B.wa[B.i][N]<<6;D=ke+je&B.J;D>=mf&&(D=lf(B,D));E.push(D);E.push(je);E.push(R);E.push(N&7);E.push(ke);E.push(B.J)}else D&=65535,D>=Pe&&(D|=B.K),E.push(D);return null}function e(D){return Wf[D]||"?"}function f(D,B){var E="",R=B&Xf;if(R==U)E=a.V+((D&255)<<24>>23)&65535,E=h(E);else if(R==Yf)E=a.V-((D&63)<<1)&65535,E=h(E);else if(R==Zf)E=C(k,D&7,0,3,"");else if(R==
$f)E=C(k,D&63,0,6,"");else if(R==ag)E=C(k,D&255,0,8,"");else if(D&=B,B&V&&(D>>=6,B>>=6),B&W){R=null;var N=D&7;switch(D&56){case 0:E=e(N);break;case 8:E="@"+e(N);R=d(k.I.h[N]);break;case 16:7>N?E="("+e(N)+")+":(B=g(),E="#"+h(B));break;case 24:7>N?E="@("+e(N)+")+":(B=g(),E="@#"+h(B),R=d(B));break;case 32:E="-("+e(N)+")";break;case 40:E="@-("+e(N)+")";break;case 48:B=g();E=h(B)+"("+e(N)+")";7==N&&(E=h(B=B+a.V&65535),R=d(B));break;case 56:B=g(),E="@"+h(B)+"("+e(N)+")",7==N&&(E="@"+h(B=B+a.V&65535),D=
k.I,D.la++,B=D.o.ma(nf(D,B,Rf)),D.la--,R=d(B))}R&&(E=[E,R])}return E}function g(){var D=b.shift()|b.shift()<<8;p+=h(D)+" ";nd(k,a,2);return D}function h(D){return C(k,D,0,16,"")}var k=this,n=Kd(this,a),p="",q=md(this,a,Vd.zc),r=md(this,a,Vd.hc),w=g(),x;for(A in this.va)if(x=this.va[A][w&A])break;x||(x=bg);var u=x[0];0<=this.O.indexOf(u)&&(x=bg,u=x[0]);var A=cg[u];var t="",Ea=x.length-1;u||Ea||(t=h(w));for(u=1;u<=Ea;u++){var X=x[u];if(void 0!=X){X=f(w,X);if(!X||!X.length){t="INVALID";break}"string"!=
typeof X&&(X=X[0]);0<t.length&&(t+=",");t+=X||"???"}}n=this.L("%s %-21s %-7s %s",n,p,A,t);c?r&&(c+=" "+r):r&&(c=r);c&&(n=this.L("%-32s; %s",n,c));q&&(n=q+":\n"+n);return n+"\n"};
var cg=".WORD ADC ADCB ADD ASL ASLB ASR ASRB BCC BCS BEQ BGE BGT BHI BIC BICB BIS BISB BIT BITB BLE BLOS BLT BMI BNE BPL BPT BR BVC BVS CCC CLC CLCN CLCV CLCVN CLCVZ CLCZ CLCZN CLN CLR CLRB CLV CLVN CLVZ CLVZN CLZ CLZN CMP CMPB COM COMB DEC DECB INC INCB HALT JMP JSR MARK MFPD MFPI MFPS MOV MOVB MTPD MTPI MTPS NEG NEGB NOP RESET ROL ROLB ROR RORB RTI RTS SBC SBCB SCC SEC SECN SECV SECVN SECVZ SECZ SECZN SEN SEV SEVN SEVZ SEVZN SEZ SEZN SUB SWAB SXT TST TSTB WAIT MUL DIV ASH ASHC XOR SOB EMT TRAP SPL IOT RTT MFPT".split(" "),Wf=
"R0 R1 R2 R3 R4 R5 SP PC A0 A1 A2 A3 A4 A5 A6 A7 S0 S1 S2 S3 PS PI ER SL M0 M1 M2 M3 AR DR SR".split(" "),W=63,V=4032,U=4096,Yf=8192,Zf=12288,$f=24576,ag=32768,Xf=61440,Tf={61440:{4096:[62,V,W],8192:[47,V,W],12288:[18,V,W],16384:[14,V,W],20480:[16,V,W],24576:[3,V,W],36864:[63,V,W],40960:[48,V,W],45056:[19,V,W],49152:[15,V,W],53248:[17,V,W],57344:[94,V,W]},65024:{2048:[57,448,W],28672:[100,W,448],29184:[101,W,448],29696:[102,W,448],30208:[103,W,448],30720:[104,448,W],32256:[105,448,Yf]},65280:{256:[27,
U],512:[24,U],768:[10,U],1024:[11,U],1280:[22,U],1536:[12,U],1792:[20,U],32768:[25,U],33024:[23,U],33280:[13,U],33536:[21,U],33792:[28,U],34048:[29,U],34304:[8,U],34560:[9,U],34816:[106,ag],35072:[107,ag]},65472:{64:[56,W],192:[95,W],2560:[39,W],2624:[49,W],2688:[53,W],2752:[51,W],2816:[67,W],2880:[1,W],2944:[77,W],3008:[97,W],3072:[73,W],3136:[71,W],3200:[6,W],3264:[4,W],3328:[58,$f],3392:[60,W],3456:[65,W],3520:[96,W],35328:[40,W],35392:[50,W],35456:[54,W],35520:[52,W],35584:[68,W],35648:[2,W],
35712:[78,W],35776:[98,W],35840:[74,W],35904:[72,W],35968:[7,W],36032:[5,W],36096:[66,W],36160:[59,W],36224:[64,W],36288:[61,W]},65528:{128:[76,7],152:[108,Zf]},65535:{0:[55],1:[99],2:[75],3:[26],4:[109],5:[70],6:[110],7:[111],160:[69],161:[31],162:[41],163:[33],164:[45],165:[36],166:[43],167:[35],168:[38],169:[32],170:[42],171:[34],172:[46],173:[37],174:[44],175:[30],176:[69],177:[80],178:[88],179:[82],180:[92],181:[85],182:[90],183:[84],184:[87],185:[81],186:[89],187:[83],188:[93],189:[86],190:[91],
191:[79]}},bg=[0],Uf=[58,60,65,96,110,100,101,102,103,104,105],Vf=[108,59,64];z.PDP11Dbg=Sf;function dg(a,b,c){Yc.call(this,a,b,c);for(var d in eg){var e=eg[d];d=+d;a=e[0];b=e[1];c=e[2];e=e[3];65472<=d&&65487>=d&&(!a&&c&&(a=function(f){return function(g){return f(g)&255}}(c)),!b&&e&&(b=function(f){return function(g,h){return f(g,h)}}(e)));Zc(this,this,d,d,a,b,c,e)}this.qa()}v(dg,Yc);l=dg.prototype;l.pa=function(){void 0===this.I&&(this.I=O(this,"Debugger"))};
l.xa=function(a){return a&&(a=a.shift(),this.S==a)?!0:!1};l.ya=function(a){a.push(this.S)};l.Ve=function(a){a=a>>1&63;var b=this.I.Qa[a>>1];return a&1?b>>16:b&65535};l.tf=function(a,b){a=a>>1&63;var c=a>>1;this.I.Qa[c]=a&1?this.I.Qa[c]&65535|(b&63)<<16:this.I.Qa[c]&-65536|b&65534};var fg={},eg=(fg[61568]=[null,null,dg.prototype.Ve,dg.prototype.tf,"UNIMAP",64,Yd],fg);z.IOPage=dg;y.qd=4294967296;J.dl11=y.qd;
function Y(a,b,c){L.call(this,a,b,c);this.N=+this.v.baudReceive||9600;this.R=+this.v.baudTransmit||9600;this.time=O(this,"Time");this.T=Jb(this.time,this.S+".receive",this.dd.bind(this));this.U=Jb(this.time,this.S+".transmit",this.gf.bind(this));this.ports=O(this,"IOPage");$c(this.ports,this,gg);this.j="";this.i=this.l=this.s=null;this.exports={connect:this.Ge,receiveData:this.dd,receiveStatus:this.bf,setConnection:this.df};this.qa()}v(Y,L);l=Y.prototype;
l.Ge=function(a){if(!this.i){var b=vb(this,"connection");if(b){var c=b.split("->");if(2==c.length){var d=c[0].trim();if(d!=this.S)return;c=c[1].trim();if(this.i=rb(this,c)){var e=this.i.exports;if(e){var f=e.connect;f&&f.call(this.i,this.J);if(this.l=e.receiveData){this.J=a;this.s=e.receiveStatus;this.u("Connected %s.%s to %s\n",this.Y,d,c);return}}}}this.u("Unable to establish connection: %s\n",b)}}};
l.xa=function(a){var b=a.shift();return this.S==b?(this.m=a.shift(),this.g=a.shift(),this.h=a.shift(),this.H=a.shift(),!0):!1};l.ya=function(a){a.push(this.S);a.push(this.m);a.push(this.g);a.push(this.h);a.push(this.H)};l.pa=function(){this.I||(this.I=O(this,"CPU"),this.M=Qe(this.I,this.O?-1:48,y.ab),this.o=Qe(this.I,this.O?-1:52,y.ab))};l.qa=function(){this.m=0;this.g=8192;this.h=128;this.H=[]};
l.dd=function(a){null!=a&&(this.j="number"!=typeof a?a:this.j+String.fromCharCode(a));this.j&&(a=this.j.charCodeAt(0),this.u(y.ab,"receiveByte(%#04x)\n",a),this.K?a=!1:(this.m=a,this.g&128?this.m|=49152:this.g|=128,this.g&64&&Se(this.I,this.M),a=!0),a&&(this.j=this.j.substr(1)),this.j&&Ob(this.time,this.T,1E3/Math.round(this.N/10)));return!0};l.bf=function(a){var b=this.g;this.g&=-12289;a&ta.jc.ua&&(this.g|=8192);a&ta.dc.ua&&(this.g|=4096);b!=this.g&&(this.g|=32768,this.g&32&&Se(this.I,this.M))};
l.df=function(a,b){return this.i?!1:(this.i=a,this.l=b,!0)};l.gf=function(a){var b=!0;this.h|=128;this.h&64&&Se(this.I,this.o);a&&(b=this.l?this.l.call(this.i,a):!1);return b};l.Ue=function(){var a=this.g&65534;this.g&=-32769;return a};l.sf=function(a){var b=a^this.g;this.g=this.g&-112|a&111;this.s&&b&6&&(b=0,this.J?(b|=a&4?ta.jc.ua:0,b|=a&2?ta.sd.ua|ta.dc.ua:0):(b|=a&4?ta.Yd.ua:0,b|=a&2?ta.td.ua:0),this.s.call(this.i,b))};l.Te=function(){this.g&=-129;return this.m};l.rf=function(){};l.af=function(){return this.h};
l.zf=function(a){if(this.h&128)if(a&64)Se(this.I,this.o);else{var b=this.I,c=this.o;if(c){var d=b.l;if(d==c)b.l=c.next;else for(;d;){var e=d.next;if(e==c){d.next=e.next;break}d=e}b.l&&(b.g|=re);b.u(y.INT+c.message,"clearIRQ(vector=%o,priority=%d)\n",c.vb,c.priority+")")}}this.h=this.h&-70|a&69};l.$e=function(){return 0};
l.yf=function(a){a:{a&=255;this.u(y.ab,"transmitByte(%#04x)\n",a);if(this.W){if(19==a){this.K=!0;break a}if(17==a){this.K=!1;break a}}this.l&&this.l.call(this.i,a);Ob(this.I,this.U,1E3/Math.round(this.R/10))}this.h&=-129};var hg={},gg=(hg[65392]=[null,null,Y.prototype.Ue,Y.prototype.sf,"RCSR"],hg[65394]=[null,null,Y.prototype.Te,Y.prototype.rf,"RBUF"],hg[65396]=[null,null,Y.prototype.af,Y.prototype.zf,"XCSR"],hg[65398]=[null,null,Y.prototype.$e,Y.prototype.yf,"XBUF"],hg);z.DL11=Y;y.Da=8589934592;
J.pc11=y.Da;
function Z(a,b,c){L.call(this,a,b,c);this.name=this.v.name||"PTR";this.h=vb(this,"autoLoad")||"";this.R=+this.v.baudReceive||3600;this.i=this.v.library||[];this.s=null;this.M=window&&"FileReader"in window;this.J=O(this,"Bus");this.time=O(this,"Time");this.T=Jb(this.time,this.S+".reader",this.ne.bind(this));O(this,"Input");this.H=null;this.m=this.g=0;this.K=32768;this.j=this.N=0;this.o=[];this.l=ig;this.O=-1;this.ports=O(this,"IOPage");$c(this.ports,this,jg);Va(this,this.i,this.Ke.bind(this))||yb(this,
!1)}v(Z,L);l=Z.prototype;
l.Na=function(a,b){var c=this,d=ig;switch(a){case "readTape":d=kg;case "loadTape":d||(d=lg);b.onclick=function(){var e=c.ca[mg];e&&(e=c.i[e.selectedIndex])&&ng(c,e,d)};break;case "mountTape":if(!this.M){this.u("Local tape support not available\n");b.parentNode.removeChild(b);break}b.addEventListener("change",function(){var e=b.children[0];e.children[1].disabled=!e.children[0].files.length});b.onsubmit=function(e){(e=e.currentTarget[1].files[0])&&ng(c,{name:Aa(e.name,!0),path:e.name},lg,e);return!1};
break;default:L.prototype.Na.call(this,a,b)}};l.Ie=function(){var a=this.ca[og],b=this.ca[mg],c=b.options[b.selectedIndex];if(a&&c){b={};if(c=c.getAttribute("data-value"))try{b=eval("("+c+")")}catch(d){this.u("PC11 option error: %s",d.message)}c=b.desc;void 0===c&&(c="");b=b.href;void 0!==b&&(c='<a href="'+b+'" target="_blank">'+c+"</a>");a.innerHTML=c}};l.xa=function(a){a=a.shift();return this.S==a?!0:!1};l.ya=function(a){a.push(this.S)};
l.pa=function(){this.I||(this.I=O(this,"CPU"),this.H=Qe(this.I,56,y.Da))};l.qa=function(){this.g&=-2241;this.m=0};
function ng(a,b,c,d){var e=b.name,f=b.path;a.u(y.Da,'load("%s","%s")\n',e,f);if(!f)return pg(a),!0;if(f==qg)return Oa(a,'Use "Choose File" and "Mount" to select and load a local tape.'),!0;if(f==rg){f=window.prompt("Enter the URL of a remote tape image.","")||"";if(!f)return!1;e=Aa(f);a.u('Attempting to load %s as "%s"',f,e)}a.l=c;if(d){var g=new FileReader;g.onload=function(){var h=g.result;h&&(b.values=new Uint8Array(h,0,h.byteLength),a.Pb(b));sg(a)};g.readAsArrayBuffer(d);return!1}if(!b.values&&
!Va(a,b.path,a.Pb.bind(a)))return!1;a.Pb(b);return!0}function sg(a){if(a.s){var b=a.ca[mg];if(b&&b.options){var c;for(c=0;c<b.options.length;c++)if(b.options[c].value==a.s.path){b.selectedIndex!=c&&(b.selectedIndex=c);break}c==b.options.length&&(b.selectedIndex=0)}}}function tg(a,b){b|=0;if(b!==a.O){var c=a.ca[ug];c&&(c=(c=c.getElementsByClassName(vg))&&c[0])&&c.style&&(c.style.width=b+"%");a.O=b}}
l.Ke=function(a){a=this.i=a||[];var b=this.Ie.bind(this),c=mg,d=this.ca[c];if(d){for(var e=0;e<a.length;e++)Pb(this,c,a[e].name,a[e].path);b&&(d.onchange=b)}Pb(this,mg,"None",wg,!0);this.M&&Pb(this,mg,"Local Tape",qg);Pb(this,mg,"Remote Tape",rg);yb(this,!0);if(this.h&&"string"==typeof this.h){for(a=0;a<this.i.length;a++)if(b=this.i[a],"object"==typeof b&&b.name==this.h){this.h=b;break}a==this.i.length&&(Oa(this,"Unable to find %s media: %s",this.S),this.h="")}this.h?ng(this,this.h,lg)||yb(this,!1):
sg(this)};
l.Pb=function(a){var b=a.name,c=a.values,d=a.addrLoad,e=a.addrExec;this.s=a;yb(this,!0);if(this.l==kg){var f=e,g=a=!1;e=!1;if(null==d)for(var h=0;h<c.length-1;){var k=c[h]&255|(c[h+1]&255)<<8;if(k)if(k&255){var n=h;if(1!=k){this.u(y.Da,"invalid signature (%#06x) at offset %#06x\n",k,n);break}if(h+6>=c.length){this.u(y.Da,"invalid block at offset %#06x\n",n);break}h+=2;var p=c[h++]&255|(c[h++]&255)<<8,q=c[h++]&255|(c[h++]&255)<<8;k+=(p&255)+(p>>8)+(q&255)+(q>>8);for(var r=h,w=p-=6;0<p&&h<c.length;)k+=
c[h++]&255,p--;if(0!=p||h>=c.length){this.u(y.Da,"insufficient data for block at offset %#06x\n",n);break}k+=c[h++]&255;if(k&255){this.u(y.Da,"invalid checksum (%#04x) for block at offset %#06x\n",k,n);break}if(w)for(this.u(y.Da,"loading %#06x bytes at %#06x-%#06x\n",w,q,q+w);w--;)this.J.hb(q++,c[r++]&255);else q&1?g=!0:null==f&&(f=q),null!=f&&this.u(y.Da,"starting address: %#06x\n",f);e=!0}else h++;else h+=2}if(!e&&(null==d&&(d=null),null!=d)){for(e=0;e<c.length;e++)this.J.hb(d+e,c[e]);e=!0}if(e){if(null==
f||g)zc(this.time),a=!1;if(null!=f&&(c=this.I,d=f,c.T=d,c.h[gf]=d&65535,ne(c,0),fe(c),a)){c.h[0]=0;for(a=1;5>=a;a++)c.h[a]=0;c.h[6]=1024}}e?this.u('Read tape "%s"',b):Oa(this,'No valid memory address for tape "%s"',b)}else this.j=0,this.o=c,this.g&=-32769,this.u('Loaded tape "%s" (%d bytes)',b,c.length),tg(this,0)};function pg(a){a.s=null;a.l&&a.u(a.l==lg?"tape detached":"tape unloaded");a.l=ig;sg(a)}
l.ne=function(){1!=(this.g&32769)||this.g&128||(this.j<this.o.length?(this.m=this.o[this.j]&255,this.u(y.Da,"%s.advanceReader(%d): %#02x\n",this.S,this.j,this.m),this.j++,tg(this,this.j/this.o.length*100)):this.g|=32768,this.g|=128,this.g&=-2049,this.g&64&&Se(this.I,this.H))};l.Se=function(){return this.g&65534};l.qf=function(a){a&1&&(this.g&32768?(a&=-2,this.g&64&&Se(this.I,this.H)):(this.g&=-129,this.g|=2048,this.m=0,Ob(this.time,this.T,1E3/Math.round(this.R/10))));this.g=this.g&-66|a&65};
l.Re=function(){this.g&=-129;this.g|=2048;return this.m};l.pf=function(){};l.Qe=function(){return this.K};l.nf=function(a){this.K=this.K&-65|a&64};l.Pe=function(){return this.N};l.mf=function(a){this.N=a&255};
var wg="",qg="?",rg="??",ig=0,lg=1,kg=2,mg="listTapes",og="descTape",ug="readProgress",vg="progressBar",xg={},jg=(xg[65384]=[null,null,Z.prototype.Se,Z.prototype.qf,"PRS"],xg[65386]=[null,null,Z.prototype.Re,Z.prototype.pf,"PRB"],xg[65388]=[null,null,Z.prototype.Qe,Z.prototype.nf,"PPS"],xg[65390]=[null,null,Z.prototype.Pe,Z.prototype.mf,"PPB"],xg);z.PC11=Z;
function yg(a,b,c){L.call(this,a,a);var d=this;this.i=!1;this.o=c;this.h="";this.m=this.l=!1;yb(this,!1);this.oa=y.od;b=b.trim();"{"==b[0]?zg(this,b):(this.h=b,Wa(this.h,function(e,f,g,h){4==g&&(!h&&f?(zg(d,f),Ag(d)):d.u("error (%d) loading configuration: %s\n",h,e))}));window.addEventListener("load",function(){d.m=!0;Ag(d)});window.addEventListener($a("iOS")?"pagehide":$a("Opera")?"unload":"beforeunload",function(){Bg(d)});window.addEventListener("pageshow",function(){d.i||d.pa(!0)})}v(yg,L);
yg.prototype.Na=function(a,b){var c=this;switch(a){case Cg:b.onclick=function(){c.pa()};break;case Dg:b.onclick=function(){c.qa()}}L.prototype.Na.call(this,a,b)};
function Ag(a){var b=!0;if(a.l&&a.m){for(var c in a.g){var d=void 0,e=a.g[c];try{d=e["class"],z[d]?"Machine"==d?(a.u("PCjs %s v%3.2f\n%s\n",e.name,3,"Copyright \u00a9 2012-2022 Jeff Parsons <Jeff@pcjs.org>"),a.h&&a.u("Configuration: %s\n",a.h)):new z[d](a.Y,c,e):a.u('unrecognized %s device "%s"\n',d,c)}catch(g){e.optional||(a.u('error initializing %s device "%s": %s\n',d,c,g.message),b=!1),Ab(a,c)}}if(a.j){var f=ab(a);ub(a,function(g){return g.Ob&&!g.Ob(f)?(g.u('unable to restore state for device "%s"\n',
g.S),!1):!0})}yb(a,!0);zb(a,a.pa.bind(a,b))||a.u("machine %s not ready to power, waiting for device(s)\n",a.Y)}}
function zg(a,b){try{a.g=JSON.parse(b);var c=a.g[a.Y];if(!c){c=a.g[Aa(a.h,!0)];if(!c)throw Error("configuration missing machine ID");a.g[a.Y]=c}sb(a,c,["autoSave","autoStart"]);a.j=!1!==a.v.autoSave;a.s=!1!==a.v.autoStart;if(a.o){var d=eval("("+a.o+")"),e;for(e in d)a.v[e]=d[e]}a.l=!0}catch(f){c=f.message,(d=c.match(/position ([0-9]+)/))&&(c+=" ('"+b.substr(+d[1],40).replace(/\s+/g," ")+"...')"),G(a,"machine '"+a.Y+"' initialization error: "+c)}}
yg.prototype.pa=function(a){a=void 0===a?!this.i:a;if(xb(this)){var b=this;a&&G(this,"power on");ub(this,function(c){c.pa&&c!=b&&("CPU"!=c.v["class"]||b.s||xb(b)?c.pa(a):c.time.update(!0));return!0});(this.i=a)||G(this,"power off")}};yg.prototype.qa=function(){if(xb(this)){var a=this;ub(this,function(b){b.qa&&b!=a&&b.qa();return!0});G(this,"reset")}};function Bg(a){if(a.j){var b=[];ub(a,function(c){c.gb&&c.gb(b);return!0});hb(a,b)}a.pa(!1)}var Cg="power",Dg="reset";
window.PDP11v3=function(a,b,c){var d=new yg(a,b,c);window.command=function(e){return bb(d,e)};return d};z.Machine=yg;})()

//# sourceMappingURL=pdp11v3.js.map
